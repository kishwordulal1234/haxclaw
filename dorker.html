<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DorkHunt v4 — Bug Bounty Search Engine</title>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@400;600;700&display=swap"
        rel="stylesheet" />
    <style>
        :root {
            --bg: #040810;
            --surface: #08111c;
            --surface2: #0c1a28;
            --surface3: #101f30;
            --border: #162840;
            --border2: #1e3a55;
            --accent: #00d4ff;
            --accent2: #ff4d6d;
            --accent3: #39ff14;
            --accent4: #ffb300;
            --accent5: #b44eff;
            --text: #c0ddf0;
            --muted: #3e6a85;
            --cat-recon: #00d4ff;
            --cat-files: #ff9f43;
            --cat-vulns: #ff4d6d;
            --cat-cms: #a29bfe;
            --cat-osint: #39ff14;
            --cat-flash: #fd79a8;
            --cat-cloud: #00cec9;
            --cat-api: #fdcb6e;
        }

        [data-theme="light"] {
            --bg: #f0f4f8;
            --surface: #ffffff;
            --surface2: #e8eef5;
            --surface3: #dce6f0;
            --border: #c5d8e8;
            --border2: #a8c4d8;
            --text: #1a2a38;
            --muted: #6a8fa8;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: "Rajdhani", sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            transition:
                background 0.3s,
                color 0.3s;
        }

        body::before {
            content: "";
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(0, 212, 255, 0.02) 1px,
                    transparent 1px),
                linear-gradient(90deg,
                    rgba(0, 212, 255, 0.02) 1px,
                    transparent 1px);
            background-size: 44px 44px;
            pointer-events: none;
            z-index: 0;
        }

        [data-theme="light"] body::before {
            background-image:
                linear-gradient(rgba(0, 100, 180, 0.04) 1px,
                    transparent 1px),
                linear-gradient(90deg,
                    rgba(0, 100, 180, 0.04) 1px,
                    transparent 1px);
        }

        /* SCANLINE */
        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg,
                    transparent,
                    var(--accent),
                    transparent);
            animation: scan 8s linear infinite;
            opacity: 0.25;
            z-index: 1;
            pointer-events: none;
        }

        @keyframes scan {
            0% {
                top: 0;
            }

            100% {
                top: 100vh;
            }
        }

        .container {
            max-width: 1500px;
            margin: 0 auto;
            padding: 24px 20px;
            position: relative;
            z-index: 2;
        }

        /* HEADER */
        header {
            text-align: center;
            margin-bottom: 28px;
            padding-bottom: 22px;
            border-bottom: 1px solid var(--border);
            position: relative;
        }

        .header-controls {
            position: absolute;
            right: 0;
            top: 0;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border2);
            border-radius: 4px;
            padding: 7px 10px;
            font-size: 14px;
            cursor: pointer;
            color: var(--muted);
            transition: all 0.2s;
            line-height: 1;
        }

        .icon-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        [data-theme="light"] .icon-btn {
            background: rgba(0, 0, 0, 0.04);
        }

        .version-badge {
            display: inline-block;
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 20px;
            padding: 3px 12px;
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--accent);
            letter-spacing: 3px;
            margin-bottom: 8px;
        }

        h1 {
            font-size: clamp(24px, 5vw, 48px);
            font-weight: 700;
            letter-spacing: 3px;
            background: linear-gradient(135deg,
                    #fff 20%,
                    var(--accent) 60%,
                    #7ecfff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.1;
            margin-bottom: 4px;
        }

        [data-theme="light"] h1 {
            background: linear-gradient(135deg,
                    #1a2a38 20%,
                    #0077aa 60%,
                    #005580 100%);
            -webkit-background-clip: text;
            background-clip: text;
        }

        .subtitle {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--muted);
            letter-spacing: 2px;
        }

        /* KEYBOARD SHORTCUTS HINT */
        .kb-hint {
            font-family: "Share Tech Mono", monospace;
            font-size: 9px;
            color: var(--muted);
            letter-spacing: 1px;
            margin-top: 6px;
        }

        .kb-hint span {
            background: var(--surface2);
            border: 1px solid var(--border2);
            border-radius: 2px;
            padding: 1px 5px;
            margin: 0 2px;
            font-size: 9px;
        }

        /* TARGET BAR */
        .search-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 18px 22px;
            margin-bottom: 20px;
            display: flex;
            gap: 14px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .input-group {
            flex: 1;
            min-width: 260px;
        }

        .input-label {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--accent);
            letter-spacing: 3px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 5px;
        }

        .target-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .target-input {
            flex: 1;
            background: rgba(0, 212, 255, 0.04);
            border: 1px solid var(--border2);
            border-radius: 4px;
            padding: 10px 13px;
            font-family: "Share Tech Mono", monospace;
            font-size: 15px;
            color: var(--accent);
            outline: none;
            transition:
                border-color 0.2s,
                box-shadow 0.2s;
            caret-color: var(--accent);
        }

        [data-theme="light"] .target-input {
            background: rgba(0, 100, 180, 0.04);
            color: #005580;
        }

        .target-input::placeholder {
            color: var(--muted);
        }

        .target-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.08);
        }

        .target-input.invalid {
            border-color: var(--accent2);
        }

        .save-target-btn {
            background: rgba(57, 255, 20, 0.08);
            border: 1px solid rgba(57, 255, 20, 0.3);
            border-radius: 4px;
            padding: 10px 14px;
            font-size: 13px;
            cursor: pointer;
            color: var(--accent3);
            transition: all 0.2s;
            white-space: nowrap;
            font-family: "Rajdhani", sans-serif;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .save-target-btn:hover {
            background: rgba(57, 255, 20, 0.15);
        }

        .input-hint {
            font-size: 11px;
            color: var(--muted);
            margin-top: 4px;
            font-family: "Share Tech Mono", monospace;
        }

        .input-hint.error {
            color: var(--accent2);
        }

        .input-hint.success {
            color: var(--accent3);
        }

        .stats-bar {
            display: flex;
            gap: 18px;
            flex-wrap: wrap;
            align-items: center;
        }

        .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1px;
        }

        .stat-num {
            font-family: "Share Tech Mono", monospace;
            font-size: 20px;
            color: var(--accent);
            line-height: 1;
        }

        .stat-label {
            font-size: 9px;
            color: var(--muted);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* SAVED TARGETS PILLS */
        .targets-row {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 16px;
            align-items: center;
        }

        .targets-label {
            font-family: "Share Tech Mono", monospace;
            font-size: 9px;
            color: var(--muted);
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-right: 4px;
        }

        .target-pill {
            background: var(--surface2);
            border: 1px solid var(--border2);
            border-radius: 12px;
            padding: 4px 12px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .target-pill:hover {
            border-color: var(--accent);
            background: rgba(0, 212, 255, 0.08);
        }

        .target-pill .del-pill {
            color: var(--muted);
            font-size: 10px;
            padding: 0 2px;
            cursor: pointer;
        }

        .target-pill .del-pill:hover {
            color: var(--accent2);
        }

        #targets-row-wrap {
            display: none;
        }

        #targets-row-wrap.visible {
            display: flex;
        }

        /* TABS */
        .tabs {
            display: flex;
            gap: 2px;
            border-bottom: 2px solid var(--border);
            margin-bottom: 24px;
            overflow-x: auto;
        }

        .tab-btn {
            background: transparent;
            border: none;
            padding: 11px 20px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--muted);
            cursor: pointer;
            text-transform: uppercase;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            color: var(--text);
        }

        .tab-btn.active {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        /* LAUNCH BAR */
        .launch-bar {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .launch-all-btn {
            background: linear-gradient(135deg,
                    rgba(255, 77, 109, 0.15),
                    rgba(255, 77, 109, 0.05));
            border: 1px solid var(--accent2);
            border-radius: 4px;
            padding: 9px 18px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: var(--accent2);
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.2s;
        }

        .launch-all-btn:hover {
            background: rgba(255, 77, 109, 0.2);
            box-shadow: 0 0 20px rgba(255, 77, 109, 0.15);
        }

        .launch-cat-btn {
            background: transparent;
            border: 1px solid var(--border2);
            border-radius: 4px;
            padding: 9px 14px;
            font-family: "Rajdhani", sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: var(--muted);
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.2s;
        }

        .launch-cat-btn:hover {
            border-color: var(--accent3);
            color: var(--accent3);
        }

        .delay-note {
            font-family: "Share Tech Mono", monospace;
            font-size: 9px;
            color: var(--muted);
            margin-left: auto;
        }

        /* FILTER BAR */
        .filter-bar {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            align-items: center;
        }

        .filter-btn {
            background: transparent;
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 5px 12px;
            font-family: "Rajdhani", sans-serif;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .filter-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-btn.active {
            background: rgba(0, 212, 255, 0.08);
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-btn[data-cat="recon"].active {
            background: rgba(0, 212, 255, 0.08);
            border-color: var(--cat-recon);
            color: var(--cat-recon);
        }

        .filter-btn[data-cat="files"].active {
            background: rgba(255, 159, 67, 0.08);
            border-color: var(--cat-files);
            color: var(--cat-files);
        }

        .filter-btn[data-cat="vulns"].active {
            background: rgba(255, 77, 109, 0.08);
            border-color: var(--cat-vulns);
            color: var(--cat-vulns);
        }

        .filter-btn[data-cat="cms"].active {
            background: rgba(162, 155, 254, 0.08);
            border-color: var(--cat-cms);
            color: var(--cat-cms);
        }

        .filter-btn[data-cat="osint"].active {
            background: rgba(57, 255, 20, 0.08);
            border-color: var(--cat-osint);
            color: var(--cat-osint);
        }

        .filter-btn[data-cat="cloud"].active {
            background: rgba(0, 206, 201, 0.08);
            border-color: var(--cat-cloud);
            color: var(--cat-cloud);
        }

        .filter-btn[data-cat="api"].active {
            background: rgba(253, 203, 110, 0.08);
            border-color: var(--cat-api);
            color: var(--cat-api);
        }

        .filter-btn[data-cat="flash"].active {
            background: rgba(253, 121, 168, 0.08);
            border-color: var(--cat-flash);
            color: var(--cat-flash);
        }

        .search-filter-input {
            background: rgba(0, 212, 255, 0.04);
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 5px 11px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--text);
            outline: none;
            width: 180px;
            margin-left: auto;
        }

        .search-filter-input::placeholder {
            color: var(--muted);
        }

        .search-filter-input:focus {
            border-color: var(--accent);
        }

        [data-theme="light"] .search-filter-input {
            background: rgba(0, 100, 180, 0.04);
        }

        /* DORK SECTIONS */
        .category-section {
            margin-bottom: 24px;
        }

        .category-section.hidden {
            display: none;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            padding-bottom: 7px;
            border-bottom: 1px solid var(--border);
        }

        .category-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .category-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .category-count {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            margin-left: auto;
        }

        .btn-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(225px, 1fr));
            gap: 6px;
        }

        .dork-btn {
            position: relative;
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 10px 56px 10px 36px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
            text-align: left;
            cursor: pointer;
            transition: all 0.15s;
            overflow: hidden;
            line-height: 1.3;
        }

        [data-theme="light"] .dork-btn {
            background: rgba(0, 0, 0, 0.02);
        }

        .dork-btn::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            opacity: 0.4;
            transition: opacity 0.2s;
        }

        .dork-btn:hover {
            background: rgba(255, 255, 255, 0.04);
            transform: translateX(2px);
        }

        [data-theme="light"] .dork-btn:hover {
            background: rgba(0, 100, 180, 0.06);
        }

        .dork-btn:hover::before {
            opacity: 1;
        }

        .dork-btn.btn-hidden {
            display: none;
        }

        .dork-btn.favorited {
            border-color: rgba(255, 179, 0, 0.4);
        }

        .dork-btn.favorited::after {
            content: "★";
            position: absolute;
            right: 30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            color: var(--accent4);
            opacity: 0.7;
        }

        .btn-icon {
            position: absolute;
            left: 11px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 13px;
            opacity: 0.55;
        }

        .btn-actions {
            position: absolute;
            right: 6px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 3px;
            opacity: 0;
            transition: opacity 0.15s;
        }

        .dork-btn:hover .btn-actions {
            opacity: 1;
        }

        .btn-action-icon {
            background: rgba(255, 255, 255, 0.05);
            border: none;
            border-radius: 3px;
            padding: 0;
            font-size: 12px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.15s;
            line-height: 1;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-action-icon:hover {
            background: rgba(0, 212, 255, 0.15);
            color: var(--accent);
        }

        .cat-recon::before {
            background: var(--cat-recon);
        }

        .cat-recon:hover {
            border-color: rgba(0, 212, 255, 0.3);
        }

        .cat-files::before {
            background: var(--cat-files);
        }

        .cat-files:hover {
            border-color: rgba(255, 159, 67, 0.3);
        }

        .cat-vulns::before {
            background: var(--cat-vulns);
        }

        .cat-vulns:hover {
            border-color: rgba(255, 77, 109, 0.3);
        }

        .cat-cms::before {
            background: var(--cat-cms);
        }

        .cat-cms:hover {
            border-color: rgba(162, 155, 254, 0.3);
        }

        .cat-osint::before {
            background: var(--cat-osint);
        }

        .cat-osint:hover {
            border-color: rgba(57, 255, 20, 0.3);
        }

        .cat-cloud::before {
            background: var(--cat-cloud);
        }

        .cat-cloud:hover {
            border-color: rgba(0, 206, 201, 0.3);
        }

        .cat-api::before {
            background: var(--cat-api);
        }

        .cat-api:hover {
            border-color: rgba(253, 203, 110, 0.3);
        }

        .cat-flash::before {
            background: var(--cat-flash);
        }

        .cat-flash:hover {
            border-color: rgba(253, 121, 168, 0.3);
        }

        /* FAVORITES TAB SECTION */
        .fav-empty {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--muted);
            padding: 24px 0;
            text-align: center;
        }

        /* NOTES PANEL */
        .notes-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
        }

        .notes-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 14px;
        }

        .notes-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .notes-toolbar {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .notes-tool-btn {
            background: transparent;
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 5px 10px;
            font-family: "Rajdhani", sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
            letter-spacing: 1px;
        }

        .notes-tool-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .notes-textarea {
            width: 100%;
            background: rgba(0, 212, 255, 0.03);
            border: 1px solid var(--border2);
            border-radius: 4px;
            padding: 12px 14px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--text);
            outline: none;
            resize: vertical;
            min-height: 260px;
            line-height: 1.7;
        }

        [data-theme="light"] .notes-textarea {
            background: rgba(0, 100, 180, 0.03);
        }

        .notes-textarea:focus {
            border-color: var(--accent);
        }

        .notes-meta {
            font-family: "Share Tech Mono", monospace;
            font-size: 9px;
            color: var(--muted);
            margin-top: 6px;
            display: flex;
            justify-content: space-between;
        }

        /* AI PANEL */
        .ai-panel {
            background: var(--surface);
            border: 1px solid rgba(180, 78, 255, 0.3);
            border-radius: 6px;
            padding: 20px 22px;
            margin-bottom: 20px;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 16px;
        }

        .ai-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent5);
            letter-spacing: 3px;
            text-transform: uppercase;
        }

        .ai-badge {
            background: rgba(180, 78, 255, 0.15);
            border: 1px solid rgba(180, 78, 255, 0.4);
            border-radius: 10px;
            padding: 2px 8px;
            font-size: 9px;
            font-family: "Share Tech Mono", monospace;
            color: var(--accent5);
            letter-spacing: 2px;
        }

        .ai-input-row {
            display: flex;
            gap: 8px;
            margin-bottom: 14px;
        }

        .ai-input {
            flex: 1;
            background: rgba(180, 78, 255, 0.05);
            border: 1px solid rgba(180, 78, 255, 0.25);
            border-radius: 4px;
            padding: 10px 13px;
            font-family: "Share Tech Mono", monospace;
            font-size: 13px;
            color: var(--text);
            outline: none;
        }

        .ai-input:focus {
            border-color: var(--accent5);
        }

        .ai-input::placeholder {
            color: var(--muted);
        }

        .ai-run-btn {
            background: rgba(180, 78, 255, 0.12);
            border: 1px solid rgba(180, 78, 255, 0.4);
            border-radius: 4px;
            padding: 10px 20px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: var(--accent5);
            cursor: pointer;
            letter-spacing: 1px;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .ai-run-btn:hover {
            background: rgba(180, 78, 255, 0.22);
        }

        .ai-run-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .ai-quick-btns {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 14px;
        }

        .ai-quick {
            background: transparent;
            border: 1px solid rgba(180, 78, 255, 0.2);
            border-radius: 12px;
            padding: 4px 12px;
            font-family: "Rajdhani", sans-serif;
            font-size: 12px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .ai-quick:hover {
            border-color: var(--accent5);
            color: var(--accent5);
        }

        .ai-response {
            background: rgba(0, 0, 0, 0.25);
            border: 1px solid rgba(180, 78, 255, 0.2);
            border-radius: 4px;
            padding: 14px 16px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--text);
            min-height: 80px;
            max-height: 360px;
            overflow-y: auto;
            line-height: 1.7;
            white-space: pre-wrap;
            display: none;
        }

        .ai-response.visible {
            display: block;
        }

        [data-theme="light"] .ai-response {
            background: rgba(180, 78, 255, 0.04);
        }

        .ai-thinking {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--accent5);
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
        }

        .ai-dot {
            width: 6px;
            height: 6px;
            background: var(--accent5);
            border-radius: 50%;
            animation: pulse 1s ease-in-out infinite;
        }

        .ai-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .ai-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.2;
                transform: scale(0.8);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        .ai-result-dorks {
            margin-top: 12px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .ai-dork-chip {
            background: rgba(0, 212, 255, 0.06);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 3px;
            padding: 8px 12px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            word-break: break-all;
        }

        .ai-dork-run {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 2px;
            padding: 3px 8px;
            font-family: "Rajdhani", sans-serif;
            font-size: 11px;
            font-weight: 700;
            color: var(--accent);
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.2s;
        }

        .ai-dork-run:hover {
            background: rgba(0, 212, 255, 0.2);
        }

        /* CUSTOM BUILDER */
        .dork-builder {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
            margin-bottom: 16px;
        }

        .builder-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 16px;
        }

        .builder-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 14px;
        }

        .builder-group label {
            font-size: 10px;
            color: var(--muted);
            letter-spacing: 1px;
            text-transform: uppercase;
            display: block;
            margin-bottom: 4px;
            font-family: "Share Tech Mono", monospace;
        }

        .builder-input,
        .builder-select {
            width: 100%;
            background: rgba(0, 212, 255, 0.03);
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 8px 11px;
            font-family: "Share Tech Mono", monospace;
            font-size: 13px;
            color: var(--text);
            outline: none;
        }

        [data-theme="light"] .builder-input,
        [data-theme="light"] .builder-select {
            background: rgba(0, 100, 180, 0.03);
        }

        .builder-input:focus,
        .builder-select:focus {
            border-color: var(--accent);
        }

        .builder-select option {
            background: #0a1520;
            color: var(--text);
        }

        .builder-preview {
            background: rgba(0, 0, 0, 0.25);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 11px 13px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--accent3);
            margin-bottom: 12px;
            word-break: break-all;
            min-height: 42px;
        }

        [data-theme="light"] .builder-preview {
            background: rgba(0, 100, 180, 0.05);
            color: #006600;
        }

        .builder-btns {
            display: flex;
            gap: 7px;
            flex-wrap: wrap;
        }

        .builder-btn {
            background: transparent;
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 8px 16px;
            font-family: "Rajdhani", sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: var(--text);
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
        }

        .builder-btn.primary {
            background: rgba(0, 212, 255, 0.08);
            border-color: var(--accent);
            color: var(--accent);
        }

        .builder-btn.primary:hover {
            background: rgba(0, 212, 255, 0.16);
        }

        .builder-btn:hover {
            border-color: var(--accent3);
            color: var(--accent3);
        }

        .saved-dorks-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-height: 280px;
            overflow-y: auto;
        }

        .saved-dork-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 9px 12px;
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid var(--border);
            border-radius: 3px;
            cursor: pointer;
            transition: background 0.15s;
        }

        [data-theme="light"] .saved-dork-item {
            background: rgba(0, 0, 0, 0.02);
        }

        .saved-dork-item:hover {
            background: rgba(0, 212, 255, 0.05);
            border-color: rgba(0, 212, 255, 0.2);
        }

        .saved-dork-name {
            font-weight: 700;
            font-size: 13px;
            flex-shrink: 0;
            min-width: 110px;
        }

        .saved-dork-query {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }

        .saved-dork-del {
            background: none;
            border: none;
            color: var(--muted);
            cursor: pointer;
            font-size: 13px;
            padding: 2px 5px;
            border-radius: 2px;
            transition: all 0.15s;
            flex-shrink: 0;
        }

        .saved-dork-del:hover {
            color: var(--accent2);
        }

        .empty-saved {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--muted);
            padding: 14px 0;
        }

        /* CHECKLIST */
        .checklist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(275px, 1fr));
            gap: 7px;
        }

        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 11px 13px;
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid var(--border);
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.15s;
            user-select: none;
        }

        [data-theme="light"] .checklist-item {
            background: rgba(0, 0, 0, 0.02);
        }

        .checklist-item:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .checklist-item.done {
            background: rgba(57, 255, 20, 0.04);
            border-color: rgba(57, 255, 20, 0.15);
        }

        .check-box {
            width: 15px;
            height: 15px;
            border: 1px solid var(--border2);
            border-radius: 2px;
            flex-shrink: 0;
            margin-top: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            transition: all 0.15s;
        }

        .checklist-item.done .check-box {
            background: rgba(57, 255, 20, 0.2);
            border-color: var(--accent3);
            color: var(--accent3);
        }

        .check-text {
            font-size: 13px;
            font-weight: 600;
            line-height: 1.3;
        }

        .check-sub {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            margin-top: 2px;
        }

        .checklist-item.done .check-text {
            color: var(--muted);
            text-decoration: line-through;
        }

        .checklist-progress {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding: 12px 16px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 4px;
        }

        .progress-bar-wrap {
            flex: 1;
            height: 5px;
            background: var(--border);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg,
                    var(--accent3),
                    var(--accent));
            border-radius: 3px;
            transition: width 0.4s ease;
        }

        .progress-text {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--accent3);
            white-space: nowrap;
        }

        .checklist-reset-btn {
            background: none;
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 4px 10px;
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .checklist-reset-btn:hover {
            border-color: var(--accent2);
            color: var(--accent2);
        }

        .checklist-section-header {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin: 16px 0 7px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border);
        }

        /* EXPORT */
        .export-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
        }

        .export-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 9px;
            margin-bottom: 18px;
        }

        .export-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 14px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        [data-theme="light"] .export-card {
            background: rgba(0, 0, 0, 0.02);
        }

        .export-card:hover {
            background: rgba(0, 212, 255, 0.05);
            border-color: rgba(0, 212, 255, 0.3);
        }

        .export-icon {
            font-size: 20px;
            display: block;
            margin-bottom: 5px;
        }

        .export-name {
            font-weight: 700;
            font-size: 13px;
            margin-bottom: 2px;
        }

        .export-desc {
            font-size: 10px;
            color: var(--muted);
            font-family: "Share Tech Mono", monospace;
        }

        .export-preview-area {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 12px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent3);
            max-height: 200px;
            overflow-y: auto;
            white-space: pre;
            margin-bottom: 12px;
            display: none;
        }

        [data-theme="light"] .export-preview-area {
            background: rgba(0, 100, 180, 0.05);
            color: #006600;
        }

        .export-preview-area.visible {
            display: block;
        }

        /* METHODOLOGY */
        .methodology-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
        }

        .methodology-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .methodology-target-info {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--muted);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .method-target-value {
            color: var(--accent);
            font-weight: bold;
        }

        .method-generate-btn {
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-family: "Rajdhani", sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: #000;
            cursor: pointer;
            transition: all 0.2s;
        }

        .method-generate-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
        }

        .methodology-steps {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .method-step {
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        [data-theme="light"] .method-step {
            background: rgba(0, 0, 0, 0.02);
        }

        .method-step-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(255, 255, 255, 0.02);
        }

        .method-step-header:hover {
            background: rgba(0, 212, 255, 0.05);
        }

        .method-step-num {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            background: rgba(0, 212, 255, 0.1);
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
        }

        .method-step-title {
            font-family: "Rajdhani", sans-serif;
            font-size: 14px;
            font-weight: 600;
            flex: 1;
        }

        .method-step-toggle {
            color: var(--muted);
            font-size: 12px;
            transition: transform 0.3s;
        }

        .method-step.collapsed .method-step-toggle {
            transform: rotate(-90deg);
        }

        .method-step-content {
            padding: 0 16px 16px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .method-step.collapsed .method-step-content {
            display: none;
        }

        .method-cmd-block {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 10px 12px;
        }

        [data-theme="light"] .method-cmd-block {
            background: rgba(0, 50, 100, 0.05);
        }

        .method-cmd-label {
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--accent2);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .method-cmd-wrap {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .method-cmd {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--accent3);
            flex: 1;
            word-break: break-all;
            background: none;
            border: none;
            padding: 0;
        }

        [data-theme="light"] .method-cmd {
            color: #006600;
        }

        .method-copy-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 6px 10px;
            font-size: 14px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .method-copy-btn:hover {
            background: rgba(0, 212, 255, 0.15);
            color: var(--accent);
            border-color: var(--accent);
        }

        .method-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }

        .method-copy-all-btn,
        .method-export-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 12px 24px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }

        .method-copy-all-btn:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: var(--accent);
            color: var(--accent);
        }

        .method-export-btn:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--accent2);
            color: var(--accent2);
        }

        /* Exploit Search Styles */
        .exploit-step {
            border-color: rgba(255, 100, 100, 0.3);
        }

        .exploit-search-box {
            background: rgba(255, 100, 100, 0.05);
            border: 1px solid rgba(255, 100, 100, 0.2);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .exploit-input-group {
            display: flex;
            gap: 10px;
        }

        .exploit-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 10px 14px;
            font-family: "Share Tech Mono", monospace;
            font-size: 13px;
            color: var(--text);
        }

        .exploit-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .exploit-search-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            border: none;
            border-radius: 4px;
            padding: 10px 20px;
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 700;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .exploit-search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 100, 100, 0.4);
        }

        .exploit-links-section {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }

        .exploit-links-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--accent);
            letter-spacing: 2px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .exploit-links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 8px;
        }

        .exploit-link {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 10px 12px;
            text-decoration: none;
            color: var(--text);
            font-size: 12px;
            transition: all 0.2s;
        }

        .exploit-link:hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .exploit-link-icon {
            font-size: 16px;
        }

        .exploit-link-name {
            font-family: "Rajdhani", sans-serif;
            font-weight: 600;
        }

        /* Exploits Tab Styles */
        .exploits-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
        }

        .exploits-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .exploits-target-info {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--muted);
        }

        .exploit-main-search {
            background: linear-gradient(135deg, rgba(255, 100, 100, 0.1), rgba(255, 50, 50, 0.05));
            border: 1px solid rgba(255, 100, 100, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .exploit-search-row {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
        }

        .exploit-main-input {
            flex: 1;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 14px 18px;
            font-family: "Share Tech Mono", monospace;
            font-size: 14px;
            color: var(--text);
        }

        .exploit-main-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 100, 100, 0.2);
        }

        .exploit-main-search-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            border: none;
            border-radius: 6px;
            padding: 14px 28px;
            font-family: "Rajdhani", sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .exploit-main-search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 100, 100, 0.5);
        }

        .exploit-quick-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .exploit-tag {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 6px 14px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .exploit-tag:hover {
            background: rgba(255, 100, 100, 0.15);
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .exploit-categories {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .exploit-category {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 16px;
        }

        .exploit-cat-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--accent);
            letter-spacing: 2px;
            margin-bottom: 12px;
            text-transform: uppercase;
        }

        .exploit-cli-section {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 16px;
        }

        .exploit-cmd-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
        }

        /* HISTORY */
        .history-section {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 18px 22px;
            margin-top: 20px;
        }

        .history-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .section-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            letter-spacing: 3px;
            color: var(--muted);
            text-transform: uppercase;
        }

        .section-actions {
            display: flex;
            gap: 5px;
        }

        .small-btn {
            background: none;
            border: 1px solid var(--border);
            border-radius: 3px;
            padding: 4px 9px;
            font-family: "Share Tech Mono", monospace;
            font-size: 10px;
            color: var(--muted);
            cursor: pointer;
            transition: all 0.2s;
        }

        .small-btn:hover {
            border-color: var(--accent2);
            color: var(--accent2);
        }

        .small-btn.green:hover {
            border-color: var(--accent3);
            color: var(--accent3);
        }

        .history-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
            max-height: 200px;
            overflow-y: auto;
        }

        .history-item {
            display: flex;
            align-items: center;
            gap: 9px;
            padding: 6px 10px;
            background: rgba(255, 255, 255, 0.015);
            border-radius: 3px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            cursor: pointer;
            transition: background 0.15s;
            border: 1px solid transparent;
        }

        [data-theme="light"] .history-item {
            background: rgba(0, 0, 0, 0.02);
        }

        .history-item:hover {
            background: rgba(0, 212, 255, 0.05);
            border-color: rgba(0, 212, 255, 0.15);
        }

        .history-domain {
            color: var(--accent);
            flex-shrink: 0;
        }

        .history-action {
            color: var(--muted);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }

        .history-time {
            color: var(--border2);
            font-size: 9px;
            flex-shrink: 0;
        }

        .empty-history {
            color: var(--muted);
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            padding: 10px 0;
        }

        /* TOAST */
        .toast-stack {
            position: fixed;
            bottom: 22px;
            right: 22px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            z-index: 1000;
            pointer-events: none;
        }

        .toast {
            background: var(--surface2);
            border: 1px solid var(--accent);
            border-radius: 4px;
            padding: 10px 16px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--accent);
            transform: translateX(20px);
            opacity: 0;
            transition: all 0.25s;
            max-width: 290px;
            pointer-events: none;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.error {
            border-color: var(--accent2);
            color: var(--accent2);
        }

        .toast.success {
            border-color: var(--accent3);
            color: var(--accent3);
        }

        .toast.warn {
            border-color: var(--accent4);
            color: var(--accent4);
        }

        .toast.ai {
            border-color: var(--accent5);
            color: var(--accent5);
        }

        /* LAUNCH OVERLAY */
        .launch-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(4, 8, 16, 0.93);
            z-index: 500;
            align-items: center;
            justify-content: center;
        }

        .launch-overlay.active {
            display: flex;
        }

        .launch-modal {
            background: var(--surface2);
            border: 1px solid var(--border2);
            border-radius: 8px;
            padding: 28px 36px;
            text-align: center;
            min-width: 300px;
        }

        .launch-modal h3 {
            font-family: "Share Tech Mono", monospace;
            font-size: 13px;
            color: var(--accent);
            letter-spacing: 3px;
            text-transform: uppercase;
            margin-bottom: 18px;
        }

        .launch-progress-bar {
            height: 4px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .launch-progress-fill {
            height: 100%;
            background: linear-gradient(90deg,
                    var(--accent),
                    var(--accent3));
            border-radius: 2px;
            transition: width 0.3s;
        }

        .launch-status {
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--muted);
        }

        .launch-cancel-btn {
            margin-top: 16px;
            background: none;
            border: 1px solid var(--accent2);
            border-radius: 3px;
            padding: 7px 18px;
            color: var(--accent2);
            font-family: "Rajdhani", sans-serif;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* KEYBOARD SHORTCUT MODAL */
        .kb-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(4, 8, 16, 0.9);
            z-index: 600;
            align-items: center;
            justify-content: center;
        }

        .kb-modal.active {
            display: flex;
        }

        .kb-modal-content {
            background: var(--surface2);
            border: 1px solid var(--border2);
            border-radius: 8px;
            padding: 28px 32px;
            max-width: 500px;
            width: 90%;
        }

        .kb-modal-title {
            font-family: "Share Tech Mono", monospace;
            font-size: 13px;
            color: var(--accent);
            letter-spacing: 3px;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .kb-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .kb-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .kb-keys {
            display: flex;
            gap: 4px;
        }

        .kb-key {
            background: var(--surface3);
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 2px 8px;
            font-family: "Share Tech Mono", monospace;
            font-size: 11px;
            color: var(--text);
        }

        .kb-desc {
            font-size: 12px;
            color: var(--muted);
            font-family: "Share Tech Mono", monospace;
        }

        .kb-close {
            margin-top: 20px;
            width: 100%;
            background: rgba(0, 212, 255, 0.08);
            border: 1px solid var(--accent);
            border-radius: 4px;
            padding: 9px;
            font-family: "Rajdhani", sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: var(--accent);
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* SCOPE CHECKER */
        .scope-panel {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 20px 22px;
            margin-bottom: 20px;
        }

        .scope-input {
            width: 100%;
            background: rgba(0, 212, 255, 0.03);
            border: 1px solid var(--border2);
            border-radius: 3px;
            padding: 9px 12px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
            color: var(--text);
            outline: none;
            min-height: 100px;
            resize: vertical;
            margin-bottom: 10px;
        }

        .scope-input:focus {
            border-color: var(--accent);
        }

        .scope-result {
            margin-top: 10px;
            font-family: "Share Tech Mono", monospace;
            font-size: 12px;
        }

        .scope-in {
            color: var(--accent3);
        }

        .scope-out {
            color: var(--accent2);
        }

        .scope-warn {
            color: var(--accent4);
        }

        /* FOOTER */
        footer {
            text-align: center;
            margin-top: 36px;
            padding-top: 18px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 18px;
        }

        .footer-link {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: 1px solid var(--border);
            border-radius: 3px;
            color: var(--muted);
            text-decoration: none;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 1px;
            transition: all 0.2s;
            text-transform: uppercase;
        }

        .footer-link:hover {
            border-color: var(--accent2);
            color: var(--accent2);
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border2);
            border-radius: 2px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--muted);
        }

        @media (max-width: 700px) {
            .search-section {
                flex-direction: column;
            }

            .btn-grid {
                grid-template-columns: 1fr;
            }

            .builder-grid {
                grid-template-columns: 1fr;
            }

            .tab-btn {
                padding: 9px 12px;
                font-size: 11px;
            }

            .header-controls {
                position: static;
                justify-content: center;
                margin-top: 10px;
            }

            .kb-list {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="scanline"></div>

    <!-- LAUNCH OVERLAY -->
    <div class="launch-overlay" id="launch-overlay">
        <div class="launch-modal">
            <h3>// Launching Dorks</h3>
            <div class="launch-progress-bar">
                <div class="launch-progress-fill" id="launch-fill" style="width: 0%"></div>
            </div>
            <div class="launch-status" id="launch-status">Preparing...</div>
            <button class="launch-cancel-btn" onclick="cancelLaunch()">
                Cancel
            </button>
        </div>
    </div>

    <!-- KEYBOARD SHORTCUTS MODAL -->
    <div class="kb-modal" id="kb-modal">
        <div class="kb-modal-content">
            <div class="kb-modal-title">⌨ Keyboard Shortcuts</div>
            <div class="kb-list">
                <div class="kb-item">
                    <div class="kb-keys">
                        <span class="kb-key">Ctrl</span><span class="kb-key">K</span>
                    </div>
                    <span class="kb-desc">Focus target input</span>
                </div>
                <div class="kb-item">
                    <div class="kb-keys">
                        <span class="kb-key">Ctrl</span><span class="kb-key">F</span>
                    </div>
                    <span class="kb-desc">Search dorks</span>
                </div>
                <div class="kb-item">
                    <div class="kb-keys">
                        <span class="kb-key">Ctrl</span><span class="kb-key">1–8</span>
                    </div>
                    <span class="kb-desc">Switch tab</span>
                </div>
                <div class="kb-item">
                    <div class="kb-keys">
                        <span class="kb-key">Ctrl</span><span class="kb-key">S</span>
                    </div>
                    <span class="kb-desc">Save current target</span>
                </div>
                <div class="kb-item">
                    <div class="kb-keys">
                        <span class="kb-key">Escape</span>
                    </div>
                    <span class="kb-desc">Close modals</span>
                </div>
                <div class="kb-item">
                    <div class="kb-keys"><span class="kb-key">?</span></div>
                    <span class="kb-desc">Show shortcuts</span>
                </div>
            </div>
            <button class="kb-close" onclick="closeKbModal()">Close</button>
        </div>
    </div>

    <!-- TOAST STACK -->
    <div class="toast-stack" id="toast-stack"></div>

    <div class="container">
        <!-- HEADER -->
        <header>
            <div class="header-controls">
                <button class="icon-btn" onclick="toggleTheme()" title="Toggle theme" id="theme-btn">
                    🌙
                </button>
                <button class="icon-btn" onclick="showKbModal()" title="Keyboard shortcuts">
                    ⌨
                </button>
                <button class="icon-btn" onclick="
                            switchTab(
                                'export',
                                document.querySelector('[data-tab=export]'),
                            )
                        " title="Export">
                    📤
                </button>
            </div>
            <div class="version-badge">v1.0.0 // 2026 EDITION</div>
            <h1>haxclaw</h1>
            <p class="subtitle">
                ADVANCED BUG BOUNTY RECON ENGINE — BY CYBERHACKS200
            </p>
            <p class="kb-hint">
                Quick keys: <span>Ctrl+K</span> focus target ·
                <span>Ctrl+F</span> search dorks · <span>?</span> all
                shortcuts
            </p>
        </header>

        <!-- TARGET BAR -->
        <div class="search-section">
            <div class="input-group">
                <label class="input-label" for="target">// target domain</label>
                <div class="target-row">
                    <input type="text" id="target" class="target-input"
                        placeholder="https://www.target.com/ or target.com" autocomplete="off" spellcheck="false"
                        oninput="validateInput(this)" onkeydown="handleEnter(event)" />
                    <button class="save-target-btn" onclick="saveTarget()">
                        + Save
                    </button>
                </div>
                <div class="input-hint" id="input-hint">
                    Paste any URL — auto-cleaned. Press Enter to lock.
                </div>
            </div>
            <div class="stats-bar">
                <div class="stat">
                    <span class="stat-num" id="stat-total">85</span><span class="stat-label">Dorks</span>
                </div>
                <div class="stat">
                    <span class="stat-num">8</span><span class="stat-label">Categories</span>
                </div>
                <div class="stat">
                    <span class="stat-num" id="search-count">0</span><span class="stat-label">Fired</span>
                </div>
                <div class="stat">
                    <span class="stat-num" id="checklist-pct">0%</span><span class="stat-label">Recon</span>
                </div>
                <div class="stat">
                    <span class="stat-num" id="fav-count">0</span><span class="stat-label">Favorites</span>
                </div>
            </div>
        </div>

        <!-- SAVED TARGETS ROW -->
        <div id="targets-row-wrap" class="targets-row">
            <span class="targets-label">Targets:</span>
            <div id="targets-pills"></div>
        </div>

        <!-- TABS -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="dorks" onclick="switchTab('dorks', this)">
                🎯 Dork Engine
            </button>
            <button class="tab-btn" data-tab="ai" onclick="switchTab('ai', this)">
                🤖 AI Assist
            </button>
            <button class="tab-btn" data-tab="favorites" onclick="switchTab('favorites', this)">
                ⭐ Favorites
            </button>
            <button class="tab-btn" data-tab="builder" onclick="switchTab('builder', this)">
                🔧 Builder
            </button>
            <button class="tab-btn" data-tab="checklist" onclick="switchTab('checklist', this)">
                ✅ Checklist
            </button>
            <button class="tab-btn" data-tab="notes" onclick="switchTab('notes', this)">
                📝 Notes
            </button>
            <button class="tab-btn" data-tab="scope" onclick="switchTab('scope', this)">
                🎯 Scope
            </button>
            <button class="tab-btn" data-tab="export" onclick="switchTab('export', this)">
                📤 Export
            </button>
            <button class="tab-btn" data-tab="methodology" onclick="switchTab('methodology', this)">
                🔥 Methodology
            </button>
            <button class="tab-btn" data-tab="exploits" onclick="switchTab('exploits', this)">
                💣 Exploits
            </button>
        </div>

        <!-- ═══════════════ TAB: DORK ENGINE ═══════════════ -->
        <div class="tab-panel active" id="tab-dorks">
            <div class="launch-bar">
                <button class="launch-all-btn" onclick="launchAll()">
                    ⚡ Fire All Dorks
                </button>
                <button class="launch-cat-btn" onclick="launchCategory()">
                    🔥 Fire Visible
                </button>
                <button class="launch-cat-btn" onclick="launchFavorites()">
                    ⭐ Fire Favorites
                </button>
                <span class="delay-note">// 800ms delay between tabs to avoid blocking</span>
            </div>
            <div class="filter-bar">
                <button class="filter-btn active" data-cat="all" onclick="filterCategory('all')">
                    All
                </button>
                <button class="filter-btn" data-cat="recon" onclick="filterCategory('recon')">
                    🔍 Recon
                </button>
                <button class="filter-btn" data-cat="files" onclick="filterCategory('files')">
                    📁 Files
                </button>
                <button class="filter-btn" data-cat="vulns" onclick="filterCategory('vulns')">
                    ⚡ Vulns
                </button>
                <button class="filter-btn" data-cat="cms" onclick="filterCategory('cms')">
                    🔧 CMS
                </button>
                <button class="filter-btn" data-cat="cloud" onclick="filterCategory('cloud')">
                    ☁️ Cloud
                </button>
                <button class="filter-btn" data-cat="api" onclick="filterCategory('api')">
                    🔌 API
                </button>
                <button class="filter-btn" data-cat="osint" onclick="filterCategory('osint')">
                    🌐 OSINT
                </button>
                <button class="filter-btn" data-cat="flash" onclick="filterCategory('flash')">
                    📼 Archive
                </button>
                <input type="text" class="search-filter-input" id="dork-search" placeholder="Search dorks..."
                    oninput="searchDorks(this.value)" />
            </div>
            <div id="dork-sections-container"></div>
            <div class="history-section">
                <div class="history-header">
                    <span class="section-title">// session history</span>
                    <div class="section-actions">
                        <button class="small-btn green" onclick="exportHistory()">
                            Export
                        </button>
                        <button class="small-btn" onclick="clearHistory()">
                            Clear
                        </button>
                    </div>
                </div>
                <div class="history-list" id="history-list">
                    <div class="empty-history">No searches yet.</div>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: AI ASSIST ═══════════════ -->
        <div class="tab-panel" id="tab-ai">
            <div class="ai-panel">
                <div class="ai-header">
                    <div class="ai-title">🤖 AI Dork Assistant</div>
                    <span class="ai-badge">POWERED BY CLAUDE</span>
                </div>
                <div class="ai-quick-btns">
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'Suggest 10 advanced Google dorks for the target domain to find sensitive files, exposed APIs and login pages',
                                )
                            ">
                        💡 Smart Dork Suggestions
                    </button>
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'Analyze the target domain and suggest what technology stack it likely uses and what vulnerabilities to focus on based on common patterns',
                                )
                            ">
                        🔍 Tech Stack Analysis
                    </button>
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'Give me a complete recon methodology checklist tailored for a bug bounty hunter targeting this domain, step by step',
                                )
                            ">
                        📋 Recon Strategy
                    </button>
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'Suggest cloud-specific Google dorks for finding exposed S3 buckets, Azure blobs, GCP storage and other cloud misconfigurations for the target',
                                )
                            ">
                        ☁️ Cloud Dorks
                    </button>
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'Generate 8 API security focused dorks to find exposed Swagger docs, GraphQL endpoints, API keys and authentication endpoints for the target',
                                )
                            ">
                        🔌 API Recon Dorks
                    </button>
                    <button class="ai-quick" onclick="
                                aiQuick(
                                    'What are the most critical vulnerabilities to look for in 2026 bug bounty programs and what dorks would help find them?',
                                )
                            ">
                        🚨 2026 Top Vulns
                    </button>
                </div>
                <div class="ai-input-row">
                    <input type="text" id="ai-prompt" class="ai-input"
                        placeholder="Ask AI anything... e.g. 'generate dorks for finding exposed Jenkins on target.com'"
                        onkeydown="if (event.key === 'Enter') runAI();" />
                    <button class="ai-run-btn" id="ai-run-btn" onclick="runAI()">
                        ⚡ Ask AI
                    </button>
                </div>
                <div id="ai-response" class="ai-response"></div>
                <div id="ai-result-dorks" class="ai-result-dorks"></div>
            </div>
            <div style="
                        background: var(--surface);
                        border: 1px solid var(--border);
                        border-radius: 6px;
                        padding: 16px 20px;
                    ">
                <div class="section-title" style="margin-bottom: 12px">
                    // ai conversation history
                </div>
                <div id="ai-history" style="
                            font-family: &quot;Share Tech Mono&quot;, monospace;
                            font-size: 11px;
                            color: var(--muted);
                            max-height: 200px;
                            overflow-y: auto;
                        ">
                    <div>No AI conversations yet.</div>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: FAVORITES ═══════════════ -->
        <div class="tab-panel" id="tab-favorites">
            <div class="launch-bar">
                <button class="launch-all-btn" onclick="launchFavorites()">
                    ⭐ Fire All Favorites
                </button>
                <span class="delay-note">// star any dork button to add it here</span>
            </div>
            <div id="favorites-grid" class="btn-grid">
                <div class="fav-empty" style="grid-column: 1/-1">
                    No favorites yet. Hover any dork and click ★ to add it.
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: CUSTOM BUILDER ═══════════════ -->
        <div class="tab-panel" id="tab-builder">
            <div class="dork-builder">
                <div class="builder-title">🔧 Custom Dork Builder</div>
                <div class="builder-grid">
                    <div class="builder-group">
                        <label>Operator</label>
                        <select class="builder-select" id="b-op" onchange="updateBuilderPreview()">
                            <option value="site:">site:</option>
                            <option value="inurl:">inurl:</option>
                            <option value="intitle:">intitle:</option>
                            <option value="intext:">intext:</option>
                            <option value="filetype:">filetype:</option>
                            <option value="ext:">ext:</option>
                            <option value="cache:">cache:</option>
                            <option value="related:">related:</option>
                            <option value="custom">
                                Custom (free text)
                            </option>
                        </select>
                    </div>
                    <div class="builder-group">
                        <label>Value / Keyword</label>
                        <input class="builder-input" id="b-val" placeholder="e.g. login, .env, admin"
                            oninput="updateBuilderPreview()" />
                    </div>
                    <div class="builder-group">
                        <label>Extra Modifiers</label>
                        <input class="builder-input" id="b-mod" placeholder='e.g. "password" -github'
                            oninput="updateBuilderPreview()" />
                    </div>
                    <div class="builder-group">
                        <label>Search Engine</label>
                        <select class="builder-select" id="b-engine">
                            <option value="google">Google</option>
                            <option value="bing">Bing</option>
                            <option value="duckduckgo">DuckDuckGo</option>
                            <option value="yandex">Yandex</option>
                        </select>
                    </div>
                </div>
                <div class="input-label" style="margin-bottom: 5px">
                    // live preview
                </div>
                <div class="builder-preview" id="builder-preview">
                    Fill fields above...
                </div>
                <div class="builder-btns">
                    <button class="builder-btn primary" onclick="runBuilderSearch()">
                        ⚡ Run
                    </button>
                    <button class="builder-btn" onclick="copyBuilderQuery()">
                        📋 Copy
                    </button>
                    <button class="builder-btn" onclick="saveBuilderDork()">
                        💾 Save
                    </button>
                    <button class="builder-btn" onclick="clearBuilder()">
                        ✕ Clear
                    </button>
                </div>
            </div>
            <div class="dork-builder">
                <div class="builder-title">
                    💾 Saved Custom Dorks
                    <span style="
                                font-size: 10px;
                                color: var(--muted);
                                margin-left: 8px;
                            " id="saved-count"></span>
                </div>
                <div class="saved-dorks-list" id="saved-dorks-list">
                    <div class="empty-saved">No saved dorks yet.</div>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: CHECKLIST ═══════════════ -->
        <div class="tab-panel" id="tab-checklist">
            <div class="checklist-progress">
                <span class="section-title">// recon progress</span>
                <div class="progress-bar-wrap">
                    <div class="progress-bar-fill" id="checklist-bar" style="width: 0%"></div>
                </div>
                <span class="progress-text" id="checklist-prog-text">0 / 0</span>
                <button class="checklist-reset-btn" onclick="resetChecklist()">
                    Reset
                </button>
            </div>
            <div id="checklist-container"></div>
        </div>

        <!-- ═══════════════ TAB: NOTES ═══════════════ -->
        <div class="tab-panel" id="tab-notes">
            <div class="notes-panel">
                <div class="notes-header">
                    <span class="notes-title">📝 Recon Notes</span>
                    <div class="section-actions">
                        <button class="small-btn green" onclick="exportNotes()">
                            Export .txt
                        </button>
                        <button class="small-btn" onclick="clearNotes()">
                            Clear
                        </button>
                    </div>
                </div>
                <div class="notes-toolbar">
                    <button class="notes-tool-btn" onclick="insertNote('## Target: ')">
                        + Target Header
                    </button>
                    <button class="notes-tool-btn" onclick="
                                insertNote(
                                    '\n### Finding\n**URL:** \n**Severity:** \n**Description:** \n**Steps:** \n',
                                )
                            ">
                        + Finding Template
                    </button>
                    <button class="notes-tool-btn" onclick="
                                insertNote(
                                    '\n---\n[' +
                                        new Date().toLocaleString() +
                                        ']\n',
                                )
                            ">
                        + Timestamp
                    </button>
                    <button class="notes-tool-btn" onclick="insertNote('\n☐ ')">
                        + Todo Item
                    </button>
                    <button class="notes-tool-btn" onclick="copyNotes()">
                        📋 Copy All
                    </button>
                </div>
                <textarea id="notes-area" class="notes-textarea" placeholder="Take recon notes here... Notes auto-save as you type.

Use the toolbar buttons above to insert templates quickly.

Example:
## Target: target.com
### Finding
**URL:** https://target.com/admin
**Severity:** High
**Description:** Exposed admin panel found via Google dork
" oninput="saveNotes()"></textarea>
                <div class="notes-meta">
                    <span id="notes-char-count">0 chars</span>
                    <span id="notes-save-status">Not saved</span>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: SCOPE CHECKER ═══════════════ -->
        <div class="tab-panel" id="tab-scope">
            <div class="scope-panel">
                <div class="builder-title">🎯 Scope Checker</div>
                <p style="
                            font-family: &quot;Share Tech Mono&quot;, monospace;
                            font-size: 11px;
                            color: var(--muted);
                            margin-bottom: 12px;
                        ">
                    Paste your bug bounty program's in-scope domains (one
                    per line). Then check if a URL/domain is in scope before
                    submitting.
                </p>
                <label class="input-label">// in-scope domains (one per line, wildcards like
                    *.example.com supported)</label>
                <textarea id="scope-input" class="scope-input"
                    placeholder="*.example.com&#10;api.example.com&#10;app.example.com&#10;*.staging.example.com"
                    oninput="saveScopeList()"></textarea>
                <div class="builder-grid" style="margin-top: 10px">
                    <div class="builder-group">
                        <label>URL or Domain to Check</label>
                        <input class="builder-input" id="scope-check-input"
                            placeholder="https://admin.example.com/login" oninput="checkScope()" />
                    </div>
                    <div class="builder-group">
                        <label>Result</label>
                        <div id="scope-result" style="
                                    font-family:
                                        &quot;Share Tech Mono&quot;, monospace;
                                    font-size: 13px;
                                    padding: 9px 0;
                                    color: var(--muted);
                                ">
                            Enter a domain above to check.
                        </div>
                    </div>
                </div>
            </div>
            <div class="scope-panel" style="margin-top: 16px">
                <div class="builder-title">📋 Program Info</div>
                <textarea id="program-notes" class="scope-input" style="min-height: 120px"
                    placeholder="Program name, platform (HackerOne / Bugcrowd / Intigriti), max bounty, special rules, known exclusions..."
                    oninput="saveProgramNotes()"></textarea>
            </div>
        </div>

        <!-- ═══════════════ TAB: EXPORT ═══════════════ -->
        <div class="tab-panel" id="tab-export">
            <div class="export-panel">
                <div class="builder-title" style="margin-bottom: 16px">
                    📤 Export Everything
                </div>
                <div class="export-options">
                    <div class="export-card" onclick="runExport('txt')">
                        <span class="export-icon">📄</span>
                        <div class="export-name">Plain Text</div>
                        <div class="export-desc">All queries list</div>
                    </div>
                    <div class="export-card" onclick="runExport('markdown')">
                        <span class="export-icon">📝</span>
                        <div class="export-name">Markdown</div>
                        <div class="export-desc">Full .md report</div>
                    </div>
                    <div class="export-card" onclick="runExport('urls')">
                        <span class="export-icon">🔗</span>
                        <div class="export-name">URL List</div>
                        <div class="export-desc">Ready search URLs</div>
                    </div>
                    <div class="export-card" onclick="runExport('json')">
                        <span class="export-icon">{ }</span>
                        <div class="export-name">JSON</div>
                        <div class="export-desc">For automation</div>
                    </div>
                    <div class="export-card" onclick="runExport('history')">
                        <span class="export-icon">🕓</span>
                        <div class="export-name">History</div>
                        <div class="export-desc">Session log</div>
                    </div>
                    <div class="export-card" onclick="runExport('saved')">
                        <span class="export-icon">💾</span>
                        <div class="export-name">Saved Dorks</div>
                        <div class="export-desc">Custom dorks</div>
                    </div>
                    <div class="export-card" onclick="runExport('notes')">
                        <span class="export-icon">📝</span>
                        <div class="export-name">Notes</div>
                        <div class="export-desc">Recon notes</div>
                    </div>
                    <div class="export-card" onclick="runExport('favorites')">
                        <span class="export-icon">⭐</span>
                        <div class="export-name">Favorites</div>
                        <div class="export-desc">Starred dorks</div>
                    </div>
                </div>
                <div class="input-label" style="margin-bottom: 5px">
                    // preview
                </div>
                <div class="export-preview-area" id="export-preview"></div>
                <div class="builder-btns" id="export-action-btns" style="display: none">
                    <button class="builder-btn primary" onclick="downloadExport()">
                        ⬇ Download
                    </button>
                    <button class="builder-btn" onclick="copyExport()">
                        📋 Copy
                    </button>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: METHODOLOGY ═══════════════ -->
        <div class="tab-panel" id="tab-methodology">
            <div class="methodology-panel">
                <div class="methodology-header">
                    <div class="builder-title">🔥 Bug Bounty Recon Methodology</div>
                    <div class="methodology-target-info">
                        Target: <span id="method-target" class="method-target-value">Not set</span>
                        <button class="method-generate-btn" onclick="generateAllCommands()">⚡ Generate All
                            Commands</button>
                    </div>
                </div>

                <div class="methodology-steps">
                    <!-- Step 1: Subdomain Discovery -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">01</span>
                            <span class="method-step-title">🌐 Subdomain Discovery</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Subfinder</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-subfinder">subfinder -d TARGET -all -o subdomains.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-subfinder')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Amass</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-amass">amass enum -passive -d TARGET -o amass.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-amass')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Assetfinder</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-assetfinder">assetfinder --subs-only TARGET >> subdomains.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-assetfinder')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Findomain</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-findomain">findomain -t TARGET -u findomain.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-findomain')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Chaos (ProjectDiscovery)</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-chaos">chaos -d TARGET -o chaos.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-chaos')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Merge & Sort Unique</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-merge-subs">cat *.txt | sort -u > all-subdomains.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-merge-subs')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: DNS Resolution -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">02</span>
                            <span class="method-step-title">📡 DNS Resolution & Filtering</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">DNSx - Resolve Subdomains</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-dnsx">dnsx -l all-subdomains.txt -o resolved.txt -a -resp</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-dnsx')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">PureDNS - Bruteforce</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-puredns">puredns bruteforce wordlist.txt TARGET -r resolvers.txt -w bruteforced.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-puredns')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">MassDNS</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-massdns">massdns -r resolvers.txt -t A -o S all-subdomains.txt -w massdns.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-massdns')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: HTTP Probing -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">03</span>
                            <span class="method-step-title">🌐 HTTP Probing</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">HTTPx - Full Probe</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-httpx">httpx -l resolved.txt -o live-hosts.txt -status-code -title -tech-detect -follow-redirects</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-httpx')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">HTTPx - With Screenshots</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-httpx-ss">httpx -l resolved.txt -screenshot -o httpx-output/</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-httpx-ss')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Httprobe</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-httprobe">cat resolved.txt | httprobe -c 50 > live-urls.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-httprobe')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Port Scanning -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">04</span>
                            <span class="method-step-title">🔍 Port Scanning</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nmap - Top Ports</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nmap">nmap -sV -sC --top-ports 1000 -iL resolved.txt -oA nmap-scan</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nmap')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Masscan - Fast Scan</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-masscan">masscan -iL resolved.txt -p1-65535 --rate 10000 -oG masscan.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-masscan')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Rustscan - Ultra Fast</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-rustscan">rustscan -a TARGET --ulimit 5000 -- -sV -sC -oN rustscan.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-rustscan')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Naabu - Port Discovery</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-naabu">naabu -l resolved.txt -p - -o ports.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-naabu')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Screenshots -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">05</span>
                            <span class="method-step-title">📷 Screenshots</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Gowitness</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-gowitness">gowitness file -f live-hosts.txt -P screenshots/ --no-http</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-gowitness')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Eyewitness</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-eyewitness">eyewitness --web -f live-hosts.txt -d eyewitness-output/</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-eyewitness')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Webscreenshot</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-webscreenshot">webscreenshot -i live-hosts.txt -o screenshots/</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-webscreenshot')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Technology Detection -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">06</span>
                            <span class="method-step-title">⚙️ Technology Detection</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Wappalyzer (CLI)</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-wappalyzer">wappalyzer https://TARGET -o tech.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-wappalyzer')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">WhatWeb</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-whatweb">whatweb -i live-hosts.txt -a 3 --log-json=whatweb.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-whatweb')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Webanalyze</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-webanalyze">webanalyze -hosts live-hosts.txt -output json > webanalyze.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-webanalyze')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: Wayback & Archive -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">07</span>
                            <span class="method-step-title">📚 Wayback & Archives</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Waybackurls</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-wayback">waybackurls TARGET > wayback.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-wayback')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">GAU (GetAllUrls)</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-gau">gau TARGET --threads 5 --o gau.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-gau')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Gauplus</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-gauplus">gauplus -t 5 -random-agent -subs TARGET > gauplus.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-gauplus')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Waymore</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-waymore">waymore -i TARGET -mode U -oU waymore.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-waymore')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 8: Content Discovery -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">08</span>
                            <span class="method-step-title">📂 Content Discovery</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">FFUF - Directory Bruteforce</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-ffuf">ffuf -u https://TARGET/FUZZ -w /usr/share/wordlists/dirb/common.txt -mc 200,301,302,403 -o ffuf.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-ffuf')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Feroxbuster</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-ferox">feroxbuster -u https://TARGET -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -o ferox.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-ferox')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Dirsearch</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-dirsearch">dirsearch -u https://TARGET -e php,asp,aspx,jsp,html,js -o dirsearch.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-dirsearch')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Gobuster</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-gobuster">gobuster dir -u https://TARGET -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o gobuster.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-gobuster')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 9: Parameter Discovery -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">09</span>
                            <span class="method-step-title">🔗 Parameter Discovery</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">ParamSpider</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-paramspider">paramspider -d TARGET -o params.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-paramspider')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Arjun</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-arjun">arjun -u https://TARGET -o arjun.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-arjun')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">x8 - Hidden Params</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-x8">x8 -u https://TARGET -w params.txt -o x8.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-x8')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Unfurl - Extract Params from URLs</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-unfurl">cat wayback.txt | unfurl -u keys | sort -u > params-list.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-unfurl')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 10: JavaScript Analysis -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">10</span>
                            <span class="method-step-title">📜 JavaScript Analysis</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Extract JS Files</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-getjs">cat wayback.txt | grep -iE "\.js$" | sort -u > js-files.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-getjs')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">LinkFinder</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-linkfinder">linkfinder -i https://TARGET -o cli > linkfinder.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-linkfinder')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">SecretFinder</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-secretfinder">secretfinder -i https://TARGET -o cli > secrets.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-secretfinder')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">JSLuice</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-jsluice">cat js-files.txt | jsluice urls | sort -u > jsluice.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-jsluice')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nuclei - JS Secrets</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nuclei-js">nuclei -l js-files.txt -t ~/nuclei-templates/exposures/ -o js-secrets.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nuclei-js')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 11: Vulnerability Scanning -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">11</span>
                            <span class="method-step-title">🛡️ Vulnerability Scanning</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nuclei - Full Scan</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nuclei">nuclei -l live-hosts.txt -t ~/nuclei-templates/ -severity critical,high,medium -o nuclei.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nuclei')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nuclei - CVEs Only</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nuclei-cve">nuclei -l live-hosts.txt -t ~/nuclei-templates/cves/ -o cves.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nuclei-cve')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nikto</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-nikto">nikto -h https://TARGET -o nikto.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nikto')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Jaeles</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-jaeles">jaeles scan -u https://TARGET -o jaeles-output/</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-jaeles')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 12: Specific Vulns -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">12</span>
                            <span class="method-step-title">🎯 Specific Vulnerability Tests</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">XSS - Dalfox</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-dalfox">dalfox file params.txt -o xss.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-dalfox')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">SQLi - SQLMap</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-sqlmap">sqlmap -m params.txt --batch --risk 3 --level 5 -o sqli.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-sqlmap')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">SSRF - SSRFmap</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-ssrfmap">ssrfmap -r request.txt -p url -m portscan</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-ssrfmap')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">LFI - LFISuite</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-lfi">cat params.txt | gf lfi | sort -u > lfi-params.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-lfi')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Open Redirect</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-openredirect">cat params.txt | gf redirect | sort -u > redirect-params.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-openredirect')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">CORS Misconfiguration</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-cors">python3 CORScanner.py -i live-hosts.txt -o cors.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-cors')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Subdomain Takeover</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-subtakeover">subzy run --targets all-subdomains.txt --output takeover.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-subtakeover')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 13: One-Liner Combos -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">13</span>
                            <span class="method-step-title">🚀 One-Liner Power Combos</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Full Subdomain Recon</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo1">subfinder -d TARGET -silent | dnsx -silent | httpx -silent -o live.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo1')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Find XSS Params</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo2">waybackurls TARGET | gf xss | sed 's/=.*/=/' | sort -u > xss-params.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo2')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Find SQLi Params</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo3">waybackurls TARGET | gf sqli | sed 's/=.*/=/' | sort -u > sqli-params.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo3')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Quick Nuclei Scan</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo4">subfinder -d TARGET -silent | httpx -silent | nuclei -severity critical,high</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo4')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Extract All Endpoints</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo5">cat wayback.txt gau.txt | sort -u | uro | httpx -silent -mc 200 > endpoints.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo5')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Find Sensitive Files</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-combo6">cat wayback.txt | grep -iE "\.(sql|bak|backup|log|env|config|xml|json|yml)$" | sort -u</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-combo6')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 14: Service & Version Detection -->
                    <div class="method-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">14</span>
                            <span class="method-step-title">📊 Service & Version Detection</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nmap Version Scan</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nmap-ver">nmap -sV -sC -O TARGET -oN version-scan.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nmap-ver')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Banner Grabbing</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-banner">nmap -sV --script=banner TARGET -oN banners.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-banner')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">HTTP Headers Check</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-headers">curl -sI https://TARGET | grep -iE "server|x-powered|x-asp|x-generator"</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-headers')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Wappalyzer Tech Stack</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-wappalyzer2">wappalyzer https://TARGET --pretty > tech-stack.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-wappalyzer2')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">CMSeek - CMS Detection</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd" id="cmd-cmseek">cmseek -u https://TARGET --batch</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-cmseek')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 15: Exploit & PoC Search -->
                    <div class="method-step exploit-step">
                        <div class="method-step-header" onclick="toggleMethodStep(this)">
                            <span class="method-step-num">15</span>
                            <span class="method-step-title">💣 Exploit & PoC Search</span>
                            <span class="method-step-toggle">▼</span>
                        </div>
                        <div class="method-step-content">
                            <div class="exploit-search-box">
                                <div class="exploit-input-group">
                                    <input type="text" id="exploit-search-term" class="exploit-input"
                                        placeholder="Enter service/version (e.g., Apache 2.4.49, nginx 1.18)">
                                    <button class="exploit-search-btn" onclick="searchExploits()">🔍 Search
                                        Exploits</button>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Searchsploit (Local)</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-searchsploit">searchsploit "apache 2.4" --json > exploits.json</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-searchsploit')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Searchsploit with Nmap</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-searchsploit-nmap">searchsploit --nmap version-scan.xml</code>
                                    <span class="method-copy-btn"
                                        onclick="copyMethodCmd('cmd-searchsploit-nmap')">⧉</span>
                                </div>
                            </div>
                            <div class="exploit-links-section">
                                <div class="exploit-links-title">🌐 Online Exploit Databases (Click to Search)</div>
                                <div class="exploit-links-grid" id="exploit-links-grid">
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('github-poc', event)">
                                        <span class="exploit-link-icon">🐙</span>
                                        <span class="exploit-link-name">GitHub PoC</span>
                                    </a>
                                    <a href="#" class="exploit-link"
                                        onclick="openExploitSearch('github-exploit', event)">
                                        <span class="exploit-link-icon">🐱</span>
                                        <span class="exploit-link-name">GitHub Exploit</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('exploitdb', event)">
                                        <span class="exploit-link-icon">💾</span>
                                        <span class="exploit-link-name">Exploit-DB</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('nvd', event)">
                                        <span class="exploit-link-icon">🛡️</span>
                                        <span class="exploit-link-name">NVD/CVE</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('packetstorm', event)">
                                        <span class="exploit-link-icon">⚡</span>
                                        <span class="exploit-link-name">PacketStorm</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('vulners', event)">
                                        <span class="exploit-link-icon">🔍</span>
                                        <span class="exploit-link-name">Vulners</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('cvedetails', event)">
                                        <span class="exploit-link-icon">📊</span>
                                        <span class="exploit-link-name">CVE Details</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('rapid7', event)">
                                        <span class="exploit-link-icon">🚀</span>
                                        <span class="exploit-link-name">Rapid7 DB</span>
                                    </a>
                                    <a href="#" class="exploit-link"
                                        onclick="openExploitSearch('nuclei-templates', event)">
                                        <span class="exploit-link-icon">☢️</span>
                                        <span class="exploit-link-name">Nuclei Templates</span>
                                    </a>
                                    <a href="#" class="exploit-link" onclick="openExploitSearch('snyk', event)">
                                        <span class="exploit-link-icon">🔐</span>
                                        <span class="exploit-link-name">Snyk Vuln DB</span>
                                    </a>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Nuclei CVE Scan</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-nuclei-cve2">nuclei -u https://TARGET -t ~/nuclei-templates/cves/ -severity critical,high -o cve-scan.txt</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-nuclei-cve2')">⧉</span>
                                </div>
                            </div>
                            <div class="method-cmd-block">
                                <div class="method-cmd-label">Metasploit Search</div>
                                <div class="method-cmd-wrap">
                                    <code class="method-cmd"
                                        id="cmd-msf">msfconsole -q -x "search type:exploit apache; exit"</code>
                                    <span class="method-copy-btn" onclick="copyMethodCmd('cmd-msf')">⧉</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Copy All Button -->
                <div class="method-actions">
                    <button class="method-copy-all-btn" onclick="copyAllCommands()">📋 Copy All Commands</button>
                    <button class="method-export-btn" onclick="exportMethodology()">📤 Export as Script</button>
                </div>
            </div>
        </div>

        <!-- ═══════════════ TAB: EXPLOITS ═══════════════ -->
        <div class="tab-panel" id="tab-exploits">
            <div class="exploits-panel">
                <div class="exploits-header">
                    <div class="builder-title">💣 Exploit & PoC Search Engine</div>
                    <div class="exploits-target-info">
                        Target: <span id="exploit-target" class="method-target-value">Not set</span>
                    </div>
                </div>

                <!-- Search Box -->
                <div class="exploit-main-search">
                    <div class="exploit-search-row">
                        <input type="text" id="exploit-service-input" class="exploit-main-input"
                            placeholder="Enter service/version (e.g., Apache 2.4.49, nginx 1.18, WordPress 5.8)">
                        <button class="exploit-main-search-btn" onclick="searchAllExploits()">🔍 Search All
                            Databases</button>
                    </div>
                    <div class="exploit-quick-tags">
                        <span class="exploit-tag" onclick="setExploitSearch('Apache')">Apache</span>
                        <span class="exploit-tag" onclick="setExploitSearch('nginx')">nginx</span>
                        <span class="exploit-tag" onclick="setExploitSearch('WordPress')">WordPress</span>
                        <span class="exploit-tag" onclick="setExploitSearch('PHP')">PHP</span>
                        <span class="exploit-tag" onclick="setExploitSearch('MySQL')">MySQL</span>
                        <span class="exploit-tag" onclick="setExploitSearch('OpenSSH')">OpenSSH</span>
                        <span class="exploit-tag" onclick="setExploitSearch('Tomcat')">Tomcat</span>
                        <span class="exploit-tag" onclick="setExploitSearch('Jenkins')">Jenkins</span>
                        <span class="exploit-tag" onclick="setExploitSearch('Log4j')">Log4j</span>
                        <span class="exploit-tag" onclick="setExploitSearch('Spring')">Spring</span>
                    </div>
                </div>

                <!-- Exploit Database Categories -->
                <div class="exploit-categories">

                    <!-- GitHub & Code Repos -->
                    <div class="exploit-category">
                        <div class="exploit-cat-title">🐙 GitHub & Code Repositories</div>
                        <div class="exploit-links-grid">
                            <a href="#" class="exploit-link" onclick="openExploitDB('github-poc', event)">
                                <span class="exploit-link-icon">🐙</span>
                                <span class="exploit-link-name">GitHub PoC</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('github-exploit', event)">
                                <span class="exploit-link-icon">🐱</span>
                                <span class="exploit-link-name">GitHub Exploit</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('github-cve', event)">
                                <span class="exploit-link-icon">💻</span>
                                <span class="exploit-link-name">GitHub CVE</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('gitlab', event)">
                                <span class="exploit-link-icon">🦊</span>
                                <span class="exploit-link-name">GitLab Exploits</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('github-nuclei', event)">
                                <span class="exploit-link-icon">☢️</span>
                                <span class="exploit-link-name">Nuclei Templates</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('github-0day', event)">
                                <span class="exploit-link-icon">🔴</span>
                                <span class="exploit-link-name">GitHub 0day</span>
                            </a>
                        </div>
                    </div>

                    <!-- Exploit Databases -->
                    <div class="exploit-category">
                        <div class="exploit-cat-title">💾 Exploit Databases</div>
                        <div class="exploit-links-grid">
                            <a href="#" class="exploit-link" onclick="openExploitDB('exploitdb', event)">
                                <span class="exploit-link-icon">💾</span>
                                <span class="exploit-link-name">Exploit-DB</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('packetstorm', event)">
                                <span class="exploit-link-icon">⚡</span>
                                <span class="exploit-link-name">PacketStorm</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('rapid7', event)">
                                <span class="exploit-link-icon">🚀</span>
                                <span class="exploit-link-name">Rapid7 DB</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('0day-today', event)">
                                <span class="exploit-link-icon">💥</span>
                                <span class="exploit-link-name">0day.today</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('sploitus', event)">
                                <span class="exploit-link-icon">🔥</span>
                                <span class="exploit-link-name">Sploitus</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('vulncode', event)">
                                <span class="exploit-link-icon">📜</span>
                                <span class="exploit-link-name">VulnCode-DB</span>
                            </a>
                        </div>
                    </div>

                    <!-- CVE & Vulnerability Databases -->
                    <div class="exploit-category">
                        <div class="exploit-cat-title">🛡️ CVE & Vulnerability Databases</div>
                        <div class="exploit-links-grid">
                            <a href="#" class="exploit-link" onclick="openExploitDB('nvd', event)">
                                <span class="exploit-link-icon">🛡️</span>
                                <span class="exploit-link-name">NVD/CVE</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('cvedetails', event)">
                                <span class="exploit-link-icon">📊</span>
                                <span class="exploit-link-name">CVE Details</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('vulners', event)">
                                <span class="exploit-link-icon">🔍</span>
                                <span class="exploit-link-name">Vulners</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('snyk', event)">
                                <span class="exploit-link-icon">🔐</span>
                                <span class="exploit-link-name">Snyk Vuln DB</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('cisa', event)">
                                <span class="exploit-link-icon">🏛️</span>
                                <span class="exploit-link-name">CISA KEV</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('mitre', event)">
                                <span class="exploit-link-icon">🎯</span>
                                <span class="exploit-link-name">MITRE CVE</span>
                            </a>
                        </div>
                    </div>

                    <!-- Vendor Security Advisories -->
                    <div class="exploit-category">
                        <div class="exploit-cat-title">🏢 Vendor Security Advisories</div>
                        <div class="exploit-links-grid">
                            <a href="#" class="exploit-link" onclick="openExploitDB('microsoft', event)">
                                <span class="exploit-link-icon">🪟</span>
                                <span class="exploit-link-name">Microsoft</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('oracle', event)">
                                <span class="exploit-link-icon">☀️</span>
                                <span class="exploit-link-name">Oracle</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('cisco', event)">
                                <span class="exploit-link-icon">🖥️</span>
                                <span class="exploit-link-name">Cisco</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('redhat', event)">
                                <span class="exploit-link-icon">🎩</span>
                                <span class="exploit-link-name">Red Hat</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('ubuntu', event)">
                                <span class="exploit-link-icon">🐧</span>
                                <span class="exploit-link-name">Ubuntu</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('debian', event)">
                                <span class="exploit-link-icon">🌀</span>
                                <span class="exploit-link-name">Debian</span>
                            </a>
                        </div>
                    </div>

                    <!-- Security Research & Intel -->
                    <div class="exploit-category">
                        <div class="exploit-cat-title">🔬 Security Research & Intel</div>
                        <div class="exploit-links-grid">
                            <a href="#" class="exploit-link" onclick="openExploitDB('google-security', event)">
                                <span class="exploit-link-icon">🌐</span>
                                <span class="exploit-link-name">Google P0</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('hackerone', event)">
                                <span class="exploit-link-icon">👾</span>
                                <span class="exploit-link-name">HackerOne</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('portswigger', event)">
                                <span class="exploit-link-icon">📝</span>
                                <span class="exploit-link-name">PortSwigger</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('tenable', event)">
                                <span class="exploit-link-icon">📱</span>
                                <span class="exploit-link-name">Tenable</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('qualys', event)">
                                <span class="exploit-link-icon">🌟</span>
                                <span class="exploit-link-name">Qualys</span>
                            </a>
                            <a href="#" class="exploit-link" onclick="openExploitDB('trendmicro', event)">
                                <span class="exploit-link-icon">💠</span>
                                <span class="exploit-link-name">Trend Micro</span>
                            </a>
                        </div>
                    </div>

                </div>

                <!-- Command Line Tools -->
                <div class="exploit-cli-section">
                    <div class="exploit-cat-title">💻 Command Line Tools</div>
                    <div class="exploit-cmd-grid">
                        <div class="method-cmd-block">
                            <div class="method-cmd-label">Searchsploit</div>
                            <div class="method-cmd-wrap">
                                <code class="method-cmd exploit-cmd"
                                    id="cmd-exp-searchsploit">searchsploit "SERVICE" --json > exploits.json</code>
                                <span class="method-copy-btn" onclick="copyExploitCmd('cmd-exp-searchsploit')">⧉</span>
                            </div>
                        </div>
                        <div class="method-cmd-block">
                            <div class="method-cmd-label">Metasploit Search</div>
                            <div class="method-cmd-wrap">
                                <code class="method-cmd exploit-cmd"
                                    id="cmd-exp-msf">msfconsole -q -x "search type:exploit SERVICE; exit"</code>
                                <span class="method-copy-btn" onclick="copyExploitCmd('cmd-exp-msf')">⧉</span>
                            </div>
                        </div>
                        <div class="method-cmd-block">
                            <div class="method-cmd-label">Nuclei CVE Scan</div>
                            <div class="method-cmd-wrap">
                                <code class="method-cmd exploit-cmd"
                                    id="cmd-exp-nuclei">nuclei -u https://EXPLOITTARGET -t ~/nuclei-templates/cves/ -severity critical,high</code>
                                <span class="method-copy-btn" onclick="copyExploitCmd('cmd-exp-nuclei')">⧉</span>
                            </div>
                        </div>
                        <div class="method-cmd-block">
                            <div class="method-cmd-label">Nmap Vuln Scan</div>
                            <div class="method-cmd-wrap">
                                <code class="method-cmd exploit-cmd"
                                    id="cmd-exp-nmap">nmap --script vuln EXPLOITTARGET -oN vuln-scan.txt</code>
                                <span class="method-copy-btn" onclick="copyExploitCmd('cmd-exp-nmap')">⧉</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <footer>
            <a href="https://www.instagram.com/un1kn0n3_h4rt/" target="_blank" class="footer-link">▶ unknone hart on
                insta</a>
        </footer>
    </div>

    <script>
        const enc = encodeURIComponent;

        // ══════════════════════════════════════════
        // DORK DATABASE
        // ══════════════════════════════════════════
        const DORKS = [
            // RECON
            {
                id: 1,
                cat: "recon",
                icon: "📂",
                label: "Directory Listing",
                query: (d) => `site:${d} intitle:index.of`,
            },
            {
                id: 6,
                cat: "recon",
                icon: "🔑",
                label: "Login Pages",
                query: (d) => `site:${d} inurl:login`,
            },
            {
                id: 18,
                cat: "recon",
                icon: "🌐",
                label: "Find Subdomains",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("site:*." + d)}`,
            },
            {
                id: 19,
                cat: "recon",
                icon: "🌐",
                label: "Sub-Subdomains",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("site:*.*." + d)}`,
            },
            {
                id: 13,
                cat: "recon",
                icon: "↪️",
                label: "Open Redirects",
                query: (d) =>
                    `site:${d} inurl:redir | inurl:redirect | inurl:return | inurl:src=http | inurl:r=http`,
            },
            {
                id: 16,
                cat: "recon",
                icon: "👤",
                label: "LinkedIn Employees",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("site:linkedin.com employees " + d)}`,
            },
            {
                id: 42,
                cat: "recon",
                icon: "🛠️",
                label: "Admin Portal (.aspx)",
                query: (d) => `site:${d} inurl:/admin.aspx`,
            },
            {
                id: "r8",
                cat: "recon",
                icon: "🔐",
                label: "Admin Panel (generic)",
                query: (d) =>
                    `site:${d} inurl:admin | inurl:administrator | inurl:adminpanel | inurl:backend`,
            },
            {
                id: "r9",
                cat: "recon",
                icon: "📡",
                label: "API Endpoints",
                query: (d) =>
                    `site:${d} inurl:/api/ | inurl:/api/v1/ | inurl:/api/v2/ | inurl:/rest/`,
            },
            {
                id: "r10",
                cat: "recon",
                icon: "🗒️",
                label: "robots.txt",
                url: (d) => `https://${d}/robots.txt`,
            },
            {
                id: "r11",
                cat: "recon",
                icon: "🗺️",
                label: "sitemap.xml",
                url: (d) => `https://${d}/sitemap.xml`,
            },
            {
                id: "r12",
                cat: "recon",
                icon: "🏷️",
                label: "Email Pattern Search",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("@" + d + " email")}`,
            },
            {
                id: "r13",
                cat: "recon",
                icon: "🔍",
                label: "Search All Indexed Pages",
                query: (d) => `site:${d}`,
            },
            {
                id: "r14",
                cat: "recon",
                icon: "📊",
                label: "Staging / Dev / Test Envs",
                query: (d) =>
                    `site:${d} inurl:staging | inurl:dev | inurl:test | inurl:uat | inurl:sandbox`,
            },
            // FILES
            {
                id: 2,
                cat: "files",
                icon: "⚙️",
                label: "Exposed Config Files",
                query: (d) =>
                    `site:${d} ext:xml | ext:conf | ext:cnf | ext:reg | ext:inf | ext:rdp | ext:cfg | ext:txt | ext:ora | ext:ini`,
            },
            {
                id: 3,
                cat: "files",
                icon: "🗄️",
                label: "Exposed Database Files",
                query: (d) => `site:${d} ext:sql | ext:dbf | ext:mdb`,
            },
            {
                id: 4,
                cat: "files",
                icon: "📋",
                label: "Exposed Log Files",
                query: (d) => `site:${d} ext:log`,
            },
            {
                id: 5,
                cat: "files",
                icon: "💾",
                label: "Backup & Old Files",
                query: (d) =>
                    `site:${d} ext:bkf | ext:bkp | ext:bak | ext:old | ext:backup`,
            },
            {
                id: 8,
                cat: "files",
                icon: "📄",
                label: "Public Documents (PDF/DOC)",
                query: (d) =>
                    `site:${d} ext:doc | ext:docx | ext:odt | ext:pdf | ext:rtf | ext:ppt | ext:pptx | ext:csv`,
            },
            {
                id: 12,
                cat: "files",
                icon: "📦",
                label: "Install / Setup Files",
                query: (d) =>
                    `site:${d} inurl:readme | inurl:license | inurl:install | inurl:setup | inurl:config`,
            },
            {
                id: 17,
                cat: "files",
                icon: "🔒",
                label: ".htaccess / .git Files",
                url: (d) =>
                    `https://www.google.com/search?q=${enc('inurl:"/phpinfo.php" | inurl:".htaccess" | inurl:"/.git" ' + d + " -github")}`,
            },
            {
                id: 41,
                cat: "files",
                icon: "📝",
                label: "main.yml File",
                query: (d) => `site:${d} intitle:"index of" "main.yml"`,
            },
            {
                id: 46,
                cat: "files",
                icon: "🔐",
                label: "conf.php Sensitive",
                query: (d) => `site:${d} intitle:index.of conf.php`,
            },
            {
                id: 48,
                cat: "files",
                icon: "📦",
                label: "Admin Backup Zip",
                query: (d) =>
                    `site:${d} intitle:"Index of" inurl:/backup/ "admin.zip"`,
            },
            {
                id: 59,
                cat: "files",
                icon: "🐬",
                label: "MySQL Config File",
                query: (d) => `site:${d} intitle:index.of conf.mysql`,
            },
            {
                id: 60,
                cat: "files",
                icon: "📂",
                label: "YML Sensitive Files",
                query: (d) =>
                    `site:${d} intitle:"index of" "users.yml" | "admin.yml" | "config.yml"`,
            },
            {
                id: 61,
                cat: "files",
                icon: "🐳",
                label: "docker-compose.yml",
                query: (d) =>
                    `site:${d} intitle:"index of" "docker-compose.yml"`,
            },
            {
                id: 62,
                cat: "files",
                icon: "☕",
                label: "pom.xml (Maven)",
                query: (d) =>
                    `site:${d} intext:pom.xml intitle:"index of /"`,
            },
            {
                id: 63,
                cat: "files",
                icon: "🗂️",
                label: "Exposed /etc Directory",
                query: (d) => `site:${d} intext:"Index of" intext:"/etc"`,
            },
            {
                id: "f16",
                cat: "files",
                icon: "🔑",
                label: ".env Files Exposed",
                query: (d) =>
                    `site:${d} inurl:.env | intitle:"index of" ".env"`,
            },
            {
                id: "f17",
                cat: "files",
                icon: "🍎",
                label: ".DS_Store Files",
                query: (d) => `site:${d} intitle:"index of" ".DS_Store"`,
            },
            {
                id: "f18",
                cat: "files",
                icon: "💡",
                label: "Private Keys (.pem/.key)",
                query: (d) =>
                    `site:${d} ext:pem | ext:key intitle:index.of`,
            },
            {
                id: "f19",
                cat: "files",
                icon: "🔏",
                label: "SSH Private Keys",
                query: (d) =>
                    `site:${d} intitle:"index of" "id_rsa" | "id_dsa" | ".ssh"`,
            },
            // VULNS
            {
                id: 7,
                cat: "vulns",
                icon: "💉",
                label: "SQL Errors / Injection",
                query: (d) =>
                    `site:${d} intext:"sql syntax near" | intext:"syntax error has occurred" | intext:"incorrect syntax near" | intext:"Warning: mysql_connect()" | intext:"Warning: mysql_query()"`,
            },
            {
                id: 9,
                cat: "vulns",
                icon: "🐘",
                label: "phpinfo() Page",
                query: (d) =>
                    `site:${d} ext:php intitle:phpinfo "published by the PHP Group"`,
            },
            {
                id: 11,
                cat: "vulns",
                icon: "🚪",
                label: "Backdoors / Webshells",
                query: (d) =>
                    `site:${d} inurl:shell | inurl:backdoor | inurl:wso | inurl:cmd | shadow | passwd | boot.ini`,
            },
            {
                id: 14,
                cat: "vulns",
                icon: "💥",
                label: "Apache Struts RCE",
                query: (d) => `site:${d} ext:action | ext:struts | ext:do`,
            },
            {
                id: 22,
                cat: "vulns",
                icon: "🌍",
                label: "crossdomain.xml Test",
                url: (d) => `https://${d}/crossdomain.xml`,
            },
            {
                id: 38,
                cat: "vulns",
                icon: "🗺️",
                label: "GeoServer WFS",
                query: (d) =>
                    `site:${d} inurl:"/geoserver/ows?service=wfs"`,
            },
            {
                id: 39,
                cat: "vulns",
                icon: "🗺️",
                label: "ArcGIS REST Services",
                query: (d) =>
                    `site:${d} intext:"ArcGIS REST Services Directory" intitle:"Folder: /"`,
            },
            {
                id: 44,
                cat: "vulns",
                icon: "📤",
                label: "File Upload Endpoints",
                query: (d) => `site:${d} inurl:uploadimage.php`,
            },
            {
                id: 53,
                cat: "vulns",
                icon: "💉",
                label: "SQL in URL Parameter",
                query: (d) => `site:${d} inurl:"php?sql=select" ext:php`,
            },
            {
                id: 55,
                cat: "vulns",
                icon: "📡",
                label: "JSON-RPC Exposed",
                query: (d) => `site:${d} intext:"index of" inurl:json-rpc`,
            },
            {
                id: 57,
                cat: "vulns",
                icon: "🔑",
                label: "JWKS-RSA Key File",
                query: (d) => `site:${d} intext:"index of" inurl:jwks-rsa`,
            },
            {
                id: 64,
                cat: "vulns",
                icon: "🗄️",
                label: "SQL Install Directories",
                query: (d) =>
                    `site:${d} "sql" "parent" intitle:index.of -injection`,
            },
            {
                id: "v14",
                cat: "vulns",
                icon: "🔓",
                label: "Spring Actuator Exposed",
                query: (d) =>
                    `site:${d} inurl:/actuator | inurl:/actuator/health | inurl:/actuator/env`,
            },
            {
                id: "v15",
                cat: "vulns",
                icon: "🚨",
                label: "Stack Traces / Error Pages",
                query: (d) =>
                    `site:${d} intext:"stack trace" | intext:"Traceback (most recent call last)" | intext:"Fatal error"`,
            },
            {
                id: "v16",
                cat: "vulns",
                icon: "💣",
                label: "SSRF URL Parameters",
                query: (d) =>
                    `site:${d} inurl:url= | inurl:path= | inurl:dest= | inurl:fetch=`,
            },
            {
                id: "v17",
                cat: "vulns",
                icon: "🖊️",
                label: "SSTI Indicators",
                query: (d) =>
                    `site:${d} inurl:template= | inurl:view= | inurl:layout=`,
            },
            {
                id: "v18",
                cat: "vulns",
                icon: "🧩",
                label: "XXE / XML Processing",
                query: (d) =>
                    `site:${d} ext:xml | ext:xsl | ext:xslt inurl:upload`,
            },
            {
                id: "v19",
                cat: "vulns",
                icon: "🔒",
                label: "Insecure Direct Object Ref",
                query: (d) =>
                    `site:${d} inurl:id= | inurl:user_id= | inurl:account_id=`,
            },
            // CMS
            {
                id: 10,
                cat: "cms",
                icon: "🔷",
                label: "WordPress Detection #1",
                query: (d) =>
                    `site:${d} inurl:wp- | inurl:wp-content | inurl:plugins | inurl:uploads | inurl:themes`,
            },
            {
                id: 20,
                cat: "cms",
                icon: "🔷",
                label: "WordPress Detection #2",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("inurl:wp-content | inurl:wp-includes " + d)}`,
            },
            {
                id: 40,
                cat: "cms",
                icon: "📑",
                label: "WP Invoice Files",
                query: (d) =>
                    `site:${d} inurl:/wp-content/uploads/wpo_wcpdf`,
            },
            {
                id: 45,
                cat: "cms",
                icon: "📋",
                label: "Contact Form 7 (Vuln)",
                query: (d) =>
                    `site:${d} inurl:*/wp-content/plugins/contact-form-7/`,
            },
            {
                id: 54,
                cat: "cms",
                icon: "🔑",
                label: "WP wp-config.php",
                query: (d) =>
                    `site:${d} inurl:"wp-content" intitle:"index.of" intext:wp-config.php`,
            },
            {
                id: 58,
                cat: "cms",
                icon: "💾",
                label: "WP Backup Files",
                query: (d) =>
                    `site:${d} inurl:"wp-content" intitle:"index.of" intext:backup`,
            },
            {
                id: 51,
                cat: "cms",
                icon: "🟢",
                label: "Drupal Login Page",
                query: (d) =>
                    `site:${d} inurl:user intitle:"Drupal" intext:"Log in" -"powered by"`,
            },
            {
                id: 52,
                cat: "cms",
                icon: "🟠",
                label: "Joomla Database Dir",
                query: (d) => `site:${d} inurl:/libraries/joomla/database/`,
            },
            {
                id: "c10",
                cat: "cms",
                icon: "🔵",
                label: "Laravel Debug / Whoops",
                query: (d) =>
                    `site:${d} intext:"Whoops! There was an error." | intitle:"Laravel"`,
            },
            {
                id: "c11",
                cat: "cms",
                icon: "⚡",
                label: "Symfony Debug Toolbar",
                query: (d) =>
                    `site:${d} inurl:/_profiler | intext:"Symfony Profiler"`,
            },
            {
                id: "c12",
                cat: "cms",
                icon: "💎",
                label: "Magento Admin Panel",
                query: (d) =>
                    `site:${d} inurl:/admin | intext:"Magento" intitle:"Admin"`,
            },
            {
                id: "c13",
                cat: "cms",
                icon: "🟤",
                label: "Ghost CMS",
                query: (d) =>
                    `site:${d} inurl:/ghost/ | intitle:"Ghost Admin"`,
            },
            // CLOUD
            {
                id: "cl1",
                cat: "cloud",
                icon: "🪣",
                label: "AWS S3 Bucket Links",
                query: (d) => `site:${d} inurl:s3.amazonaws.com`,
            },
            {
                id: "cl2",
                cat: "cloud",
                icon: "🪣",
                label: "Open S3 Bucket Search",
                url: (d) =>
                    `https://www.google.com/search?q=${enc(d + " site:s3.amazonaws.com")}`,
            },
            {
                id: "cl3",
                cat: "cloud",
                icon: "☁️",
                label: "Azure Blob Storage",
                query: (d) => `site:${d} inurl:blob.core.windows.net`,
            },
            {
                id: "cl4",
                cat: "cloud",
                icon: "🔵",
                label: "GCP Storage Buckets",
                query: (d) => `site:${d} inurl:storage.googleapis.com`,
            },
            {
                id: "cl5",
                cat: "cloud",
                icon: "🐳",
                label: "Docker Registry Exposed",
                query: (d) =>
                    `site:${d} inurl:/v2/ intitle:"Docker Registry"`,
            },
            {
                id: "cl6",
                cat: "cloud",
                icon: "⚙️",
                label: "Kubernetes Dashboard",
                query: (d) =>
                    `site:${d} inurl:":8001/api" | intitle:"Kubernetes Dashboard"`,
            },
            {
                id: "cl7",
                cat: "cloud",
                icon: "🔥",
                label: "Firebase Exposed DB",
                url: (d) =>
                    `https://www.google.com/search?q=${enc(d + " site:firebaseio.com")}`,
            },
            {
                id: "cl8",
                cat: "cloud",
                icon: "📊",
                label: "Grafana Dashboard Open",
                query: (d) => `site:${d} intitle:"Grafana" inurl:"/login"`,
            },
            {
                id: "cl9",
                cat: "cloud",
                icon: "🐰",
                label: "Elasticsearch Open",
                query: (d) =>
                    `site:${d} inurl:9200 intitle:"Elasticsearch"`,
            },
            {
                id: "cl10",
                cat: "cloud",
                icon: "📡",
                label: "Jenkins CI Exposed",
                query: (d) =>
                    `site:${d} intitle:"Dashboard [Jenkins]" | inurl:/jenkins/`,
            },
            {
                id: "cl11",
                cat: "cloud",
                icon: "🔑",
                label: "AWS Secrets in Code",
                query: (d) =>
                    `site:${d} intext:"AWS_ACCESS_KEY_ID" | intext:"AWS_SECRET_ACCESS_KEY"`,
            },
            {
                id: "cl12",
                cat: "cloud",
                icon: "📱",
                label: "Vercel / Netlify Previews",
                url: (d) =>
                    `https://www.google.com/search?q=${enc(d + " site:vercel.app OR site:netlify.app")}`,
            },
            // API
            {
                id: 49,
                cat: "api",
                icon: "🐙",
                label: "GitHub API Key Index",
                query: (d) => `site:${d} intitle:"index of" github-api`,
            },
            {
                id: "a1",
                cat: "api",
                icon: "🔑",
                label: "Exposed API Keys (generic)",
                query: (d) =>
                    `site:${d} intext:"api_key" | intext:"apikey" | intext:"api-key" ext:json | ext:yaml | ext:env`,
            },
            {
                id: "a2",
                cat: "api",
                icon: "🔑",
                label: "AWS Access Keys in Pages",
                query: (d) => `site:${d} intext:"AKIA" intext:"secret"`,
            },
            {
                id: "a3",
                cat: "api",
                icon: "📘",
                label: "Swagger / OpenAPI UI",
                query: (d) =>
                    `site:${d} inurl:/swagger-ui | inurl:/api-docs | intitle:"Swagger UI"`,
            },
            {
                id: "a4",
                cat: "api",
                icon: "🧪",
                label: "Postman Collections",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("site:postman.com " + d)}`,
            },
            {
                id: "a5",
                cat: "api",
                icon: "🔐",
                label: "JWT Tokens in URLs",
                query: (d) =>
                    `site:${d} inurl:token= | inurl:access_token= | inurl:jwt=`,
            },
            {
                id: "a6",
                cat: "api",
                icon: "🗝️",
                label: "OAuth / SSO Endpoints",
                query: (d) =>
                    `site:${d} inurl:/oauth/token | inurl:/oauth/authorize | inurl:/auth/callback`,
            },
            {
                id: "a7",
                cat: "api",
                icon: "📋",
                label: "GraphQL Endpoints",
                query: (d) =>
                    `site:${d} inurl:/graphql | inurl:/graphiql | intitle:"GraphiQL"`,
            },
            {
                id: "a8",
                cat: "api",
                icon: "🔓",
                label: "Exposed Stripe Keys",
                query: (d) =>
                    `site:${d} intext:"sk_live_" | intext:"pk_live_"`,
            },
            {
                id: "a9",
                cat: "api",
                icon: "📖",
                label: "Exposed Readme with Keys",
                query: (d) =>
                    `site:${d} inurl:readme intext:"key" | intext:"token" | intext:"secret"`,
            },
            // OSINT
            {
                id: 15,
                cat: "osint",
                icon: "📋",
                label: "Pastebin Leaks",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("site:pastebin.com " + d)}`,
            },
            {
                id: 23,
                cat: "osint",
                icon: "🕸️",
                label: "ThreatCrowd Lookup",
                url: (d) =>
                    `https://www.threatcrowd.org/domain.php?domain=${d}`,
            },
            {
                id: 30,
                cat: "osint",
                icon: "🔏",
                label: "Certificate Transparency",
                url: (d) => `https://crt.sh/?q=%25.${d}`,
            },
            {
                id: 31,
                cat: "osint",
                icon: "🐞",
                label: "OpenBugBounty",
                url: (d) =>
                    `https://www.openbugbounty.org/search/?search=${enc(d)}&type=host`,
            },
            {
                id: 32,
                cat: "osint",
                icon: "👽",
                label: "Reddit Mentions",
                url: (d) =>
                    `https://www.reddit.com/search/?q=${enc(d)}&source=recent`,
            },
            {
                id: 34,
                cat: "osint",
                icon: "🔭",
                label: "Censys — Hosts",
                url: (d) => `https://search.censys.io/hosts?q=${d}`,
            },
            {
                id: 36,
                cat: "osint",
                icon: "🔭",
                label: "Censys — Certificates",
                url: (d) => `https://search.censys.io/certificates?q=${d}`,
            },
            {
                id: 37,
                cat: "osint",
                icon: "👁️",
                label: "Shodan",
                url: (d) => `https://www.shodan.io/search?query=${d}`,
            },
            {
                id: "o9",
                cat: "osint",
                icon: "🦠",
                label: "VirusTotal Domain",
                url: (d) =>
                    `https://www.virustotal.com/gui/domain/${d}/relations`,
            },
            {
                id: "o11",
                cat: "osint",
                icon: "🌐",
                label: "SecurityTrails",
                url: (d) => `https://securitytrails.com/domain/${d}/dns`,
            },
            {
                id: "o13",
                cat: "osint",
                icon: "📧",
                label: "Hunter.io Email Finder",
                url: (d) => `https://hunter.io/domain-search?domain=${d}`,
            },
            {
                id: "o14",
                cat: "osint",
                icon: "🗃️",
                label: "Wayback CDX API",
                url: (d) =>
                    `https://web.archive.org/cdx/search?url=${d}/&matchType=domain&collapse=urlkey&output=text&fl=original&limit=10000`,
            },
            {
                id: 21,
                cat: "osint",
                icon: "🐙",
                label: "GitHub Subdomain Search",
                url: (d) =>
                    `https://github.com/search?q=${enc('"*.' + d + '"')}&type=host`,
            },
            {
                id: "o16",
                cat: "osint",
                icon: "📡",
                label: "Fofa Search",
                url: (d) =>
                    `https://fofa.info/result?qbase64=${btoa('domain="' + d + '"')}`,
            },
            {
                id: "o17",
                cat: "osint",
                icon: "🔍",
                label: "Google Cache",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("cache:" + d)}`,
            },
            // ARCHIVE
            {
                id: 24,
                cat: "flash",
                icon: "📼",
                label: "Find SWF (Google)",
                url: (d) =>
                    `https://www.google.com/search?q=${enc("+inurl:" + d + " +ext:swf")}`,
            },
            {
                id: 26,
                cat: "flash",
                icon: "🕰️",
                label: "SWF in Archive",
                url: (d) =>
                    `https://web.archive.org/cdx/search?url=${enc(d)}/&matchType=domain&collapse=urlkey&output=text&fl=original&filter=urlkey:.*swf&limit=100000`,
            },
            {
                id: 28,
                cat: "flash",
                icon: "📦",
                label: "Web Archive Search #1",
                url: (d) => `https://web.archive.org/web/*/(.*${enc(d)})`,
            },
            {
                id: 29,
                cat: "flash",
                icon: "📦",
                label: "Web Archive Search #2",
                url: (d) => `https://web.archive.org/web/*/${enc(d)}/*`,
            },
        ];

        // ══════════════════════════════════════════
        // CHECKLIST DATA
        // ══════════════════════════════════════════
        const CHECKLIST = [
            {
                section: "Phase 1 — Passive Recon",
                items: [
                    {
                        id: "ck1",
                        label: "Certificate transparency",
                        sub: "crt.sh, censys — enumerate subdomains from certs",
                    },
                    {
                        id: "ck2",
                        label: "DNS enumeration",
                        sub: "dnsdumpster, securitytrails, amass, subfinder",
                    },
                    {
                        id: "ck3",
                        label: "WHOIS lookup",
                        sub: "registrant info, nameservers, registration dates",
                    },
                    {
                        id: "ck4",
                        label: "ASN / IP range mapping",
                        sub: "bgp.he.net — find all IP blocks owned by target",
                    },
                    {
                        id: "ck5",
                        label: "Google dorks — subdomains",
                        sub: "site:*.target.com",
                    },
                    {
                        id: "ck6",
                        label: "GitHub recon",
                        sub: "Leaked secrets, API keys, employee emails",
                    },
                    {
                        id: "ck7",
                        label: "Shodan / Censys / Fofa scan",
                        sub: "Exposed services, ports, banners",
                    },
                    {
                        id: "ck8",
                        label: "Wayback Machine CDX crawl",
                        sub: "Extract all historic URLs",
                    },
                ],
            },
            {
                section: "Phase 2 — Active Recon",
                items: [
                    {
                        id: "ck9",
                        label: "Port scan",
                        sub: "nmap -sV -sC -p- target.com",
                    },
                    {
                        id: "ck10",
                        label: "Web tech fingerprint",
                        sub: "Wappalyzer, whatweb — detect CMS, frameworks",
                    },
                    {
                        id: "ck11",
                        label: "Directory brute-force",
                        sub: "ffuf, dirsearch, gobuster",
                    },
                    {
                        id: "ck12",
                        label: "Subdomain brute-force",
                        sub: "ffuf + wordlist or amass -active",
                    },
                    {
                        id: "ck13",
                        label: "robots.txt / sitemap.xml",
                        sub: "Review disallowed paths",
                    },
                    {
                        id: "ck14",
                        label: "HTTP security headers",
                        sub: "Missing CSP, HSTS, X-Frame-Options",
                    },
                    {
                        id: "ck15",
                        label: "JS file analysis",
                        sub: "Grep JS for secrets, endpoints, APIs",
                    },
                    {
                        id: "ck16",
                        label: "CORS misconfiguration",
                        sub: 'curl -H "Origin: evil.com"',
                    },
                ],
            },
            {
                section: "Phase 3 — Vulnerability Testing",
                items: [
                    {
                        id: "ck17",
                        label: "Test all login forms",
                        sub: "Default creds, brute force, lockout policy",
                    },
                    {
                        id: "ck18",
                        label: "SQLi testing",
                        sub: "sqlmap or manual on all params",
                    },
                    {
                        id: "ck19",
                        label: "XSS testing",
                        sub: "Reflected, stored, DOM — all surfaces",
                    },
                    {
                        id: "ck20",
                        label: "IDOR / BAC testing",
                        sub: "Enumerate IDs, change user context",
                    },
                    {
                        id: "ck21",
                        label: "SSRF testing",
                        sub: "URL params pointing to external resources",
                    },
                    {
                        id: "ck22",
                        label: "File upload testing",
                        sub: "Upload PHP, SVG, HTML — check execution",
                    },
                    {
                        id: "ck23",
                        label: "Open redirect testing",
                        sub: "url=, next=, redir=, to= params",
                    },
                    {
                        id: "ck24",
                        label: "API security testing",
                        sub: "Auth, rate limiting, mass assignment, GraphQL",
                    },
                    {
                        id: "ck25",
                        label: "Check .env / secrets",
                        sub: "curl /.env, /.git/config, /config.json",
                    },
                    {
                        id: "ck26",
                        label: "Business logic flaws",
                        sub: "Price manipulation, coupon abuse, negative values",
                    },
                ],
            },
            {
                section: "Phase 4 — Reporting",
                items: [
                    {
                        id: "ck27",
                        label: "Document findings with PoC",
                        sub: "Screenshots, CVSS score, repro steps",
                    },
                    {
                        id: "ck28",
                        label: "Verify scope and RoE",
                        sub: "Confirm in-scope before submitting",
                    },
                    {
                        id: "ck29",
                        label: "Submit to platform",
                        sub: "HackerOne, Bugcrowd, Intigriti",
                    },
                    {
                        id: "ck30",
                        label: "Follow up on triage",
                        sub: "Respond to triage requests quickly",
                    },
                ],
            },
        ];

        // ══════════════════════════════════════════
        // STATE
        // ══════════════════════════════════════════
        let searchCount = 0,
            launchCancelled = false;
        let history = [],
            savedDorks = [],
            checklistState = {},
            favorites = [],
            savedTargets = [];
        let exportContent = "",
            exportFilename = "";
        let aiHistory = [];

        function ls(k, d = []) {
            try {
                return JSON.parse(
                    localStorage.getItem(k) || JSON.stringify(d),
                );
            } catch (x) {
                return d;
            }
        }
        function lsSet(k, v) {
            try {
                localStorage.setItem(k, JSON.stringify(v));
            } catch (x) { }
        }

        history = ls("bbse_history", []);
        savedDorks = ls("bbse_saved", []);
        checklistState = ls("bbse_checklist", {});
        favorites = ls("bbse_favorites", []);
        savedTargets = ls("bbse_targets", []);

        // ══════════════════════════════════════════
        // INIT
        // ══════════════════════════════════════════
        function init() {
            const container = document.getElementById(
                "dork-sections-container",
            );
            const cats = [
                "recon",
                "files",
                "vulns",
                "cms",
                "cloud",
                "api",
                "osint",
                "flash",
            ];
            const catColors = {
                recon: "var(--cat-recon)",
                files: "var(--cat-files)",
                vulns: "var(--cat-vulns)",
                cms: "var(--cat-cms)",
                cloud: "var(--cat-cloud)",
                api: "var(--cat-api)",
                osint: "var(--cat-osint)",
                flash: "var(--cat-flash)",
            };
            container.innerHTML = cats
                .map((cat) => {
                    const dorks = DORKS.filter((d) => d.cat === cat);
                    return `<div class="category-section" data-cat="${cat}">
      <div class="category-header">
        <div class="category-dot" style="background:${catColors[cat]}"></div>
        <span class="category-title" style="color:${catColors[cat]}">${cat.toUpperCase()}</span>
        <span class="category-count" id="count-${cat}">${dorks.length} dorks</span>
      </div>
      <div class="btn-grid" id="grid-${cat}">
        ${dorks.map((d) => dorkBtn(d)).join("")}
      </div>
    </div>`;
                })
                .join("");
            document.getElementById("stat-total").textContent =
                DORKS.length;
            document.getElementById("fav-count").textContent =
                favorites.length;
            renderHistory();
            renderSavedDorks();
            renderChecklist();
            updateChecklistStats();
            renderFavorites();
            renderTargets();
            updateBuilderPreview();
            loadNotes();
            loadScope();
            loadTheme();
        }

        function dorkBtn(d) {
            const isFav = favorites.includes(String(d.id));
            return `<button class="dork-btn cat-${d.cat}${isFav ? " favorited" : ""}" data-id="${d.id}" data-label="${d.label.toLowerCase()}" onclick="runSearch('${d.id}')">
    <span class="btn-icon">${d.icon}</span>${d.label}
    <span class="btn-actions">
      <span class="btn-action-icon" title="Copy URL" onclick="copyDork(event,'${d.id}')">⧉</span>
      <span class="btn-action-icon" title="${isFav ? "Unfavorite" : "Favorite"}" onclick="toggleFav(event,'${d.id}')">${isFav ? "★" : "☆"}</span>
    </span>
  </button>`;
        }

        // ══════════════════════════════════════════
        // DOMAIN VALIDATION
        // ══════════════════════════════════════════
        function cleanDomain(raw) {
            return raw
                .trim()
                .replace(/^https?:\/\//i, "")
                .replace(/^\/\//, "")
                .replace(/\/.*$/, "")
                .replace(/\?.*$/, "")
                .replace(/\s+/g, "")
                .toLowerCase();
        }
        function validateInput(input) {
            const cleaned = cleanDomain(input.value);
            if (cleaned !== input.value.trim()) input.value = cleaned;
            const val = cleaned,
                hint = document.getElementById("input-hint");
            if (!val) {
                input.classList.remove("invalid");
                hint.textContent =
                    "Paste any URL — auto-cleaned. Press Enter to lock.";
                hint.className = "input-hint";
                return true;
            }
            const rx =
                /^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/;
            if (!rx.test(val)) {
                hint.textContent = "⚠ Invalid domain format";
                hint.className = "input-hint error";
                input.classList.add("invalid");
                return false;
            }
            input.classList.remove("invalid");
            hint.textContent = `✓ Target locked: ${val}`;
            hint.className = "input-hint success";
            return true;
        }
        function handleEnter(ev) {
            if (ev.key === "Enter") {
                const d = getTarget();
                if (d) toast(`Target: ${d}`, "success");
            }
        }
        function getTarget() {
            const input = document.getElementById("target");
            input.value = cleanDomain(input.value);
            if (!input.value) {
                return "";
            }
            if (!validateInput(input)) {
                toast("⚠ Invalid domain", "error");
                input.focus();
                return null;
            }
            return input.value;
        }

        // ══════════════════════════════════════════
        // SAVED TARGETS
        // ══════════════════════════════════════════
        function saveTarget() {
            const domain = getTarget();
            if (!domain) return;
            if (savedTargets.includes(domain)) {
                toast("Target already saved", "warn");
                return;
            }
            savedTargets.push(domain);
            lsSet("bbse_targets", savedTargets);
            renderTargets();
            toast(`💾 Saved: ${domain}`, "success");
        }
        function loadTarget(domain) {
            document.getElementById("target").value = domain;
            validateInput(document.getElementById("target"));
            toast(`Target: ${domain}`, "success");
        }
        function deleteTarget(domain) {
            savedTargets = savedTargets.filter((t) => t !== domain);
            lsSet("bbse_targets", savedTargets);
            renderTargets();
        }
        function renderTargets() {
            const wrap = document.getElementById("targets-row-wrap");
            const pills = document.getElementById("targets-pills");
            if (!savedTargets.length) {
                wrap.classList.remove("visible");
                return;
            }
            wrap.classList.add("visible");
            pills.innerHTML = savedTargets
                .map(
                    (t) => `
    <div class="target-pill" onclick="loadTarget('${t}')">
      ${t}<span class="del-pill" onclick="event.stopPropagation();deleteTarget('${t}')">✕</span>
    </div>`,
                )
                .join("");
        }

        // ══════════════════════════════════════════
        // RUN SEARCH
        // ══════════════════════════════════════════
        function runSearch(id) {
            const domain = getTarget();
            if (domain === null) return;
            const dork = DORKS.find((d) => String(d.id) === String(id));
            if (!dork) {
                toast("Unknown dork", "error");
                return;
            }
            const url = getDorkUrl(dork, domain);
            window.open(url, "_blank");
            searchCount++;
            document.getElementById("search-count").textContent =
                searchCount;
            addHistory(domain || "(no target)", dork.label, url);
            toast(`⚡ ${dork.label}`, "success");
        }
        function getDorkUrl(dork, domain) {
            if (dork.url) return dork.url(domain);
            if (dork.query)
                return (
                    "https://www.google.com/search?q=" +
                    enc(dork.query(domain))
                );
            return "#";
        }
        function copyDork(ev, id) {
            ev.stopPropagation();
            const domain = getTarget();
            if (domain === null) return;
            const dork = DORKS.find((d) => String(d.id) === String(id));
            if (!dork) return;
            navigator.clipboard
                .writeText(getDorkUrl(dork, domain))
                .then(() => toast("📋 Copied!", "success"))
                .catch(() => toast("Copy failed", "error"));
        }

        // ══════════════════════════════════════════
        // FAVORITES
        // ══════════════════════════════════════════
        function toggleFav(ev, id) {
            ev.stopPropagation();
            const sid = String(id);
            if (favorites.includes(sid))
                favorites = favorites.filter((f) => f !== sid);
            else favorites.push(sid);
            lsSet("bbse_favorites", favorites);
            document.getElementById("fav-count").textContent =
                favorites.length;
            init(); // re-render
            toast(
                favorites.includes(sid)
                    ? "⭐ Added to favorites"
                    : "Removed from favorites",
                "success",
            );
        }
        function renderFavorites() {
            const grid = document.getElementById("favorites-grid");
            const favDorks = DORKS.filter((d) =>
                favorites.includes(String(d.id)),
            );
            if (!favDorks.length) {
                grid.innerHTML =
                    '<div class="fav-empty" style="grid-column:1/-1">No favorites yet. Hover any dork and click ☆ to add it here.</div>';
                return;
            }
            grid.innerHTML = favDorks.map((d) => dorkBtn(d)).join("");
        }
        async function launchFavorites() {
            const domain = getTarget();
            if (domain === null) return;
            const favDorks = DORKS.filter((d) =>
                favorites.includes(String(d.id)),
            );
            if (!favDorks.length) {
                toast("No favorites yet!", "warn");
                return;
            }
            launchDorks(favDorks, domain, "Favorites");
        }

        // ══════════════════════════════════════════
        // LAUNCH ALL / CATEGORY
        // ══════════════════════════════════════════
        function launchAll() {
            const domain = getTarget();
            if (domain === null) return;
            launchDorks(DORKS, domain, "All");
        }
        function launchCategory() {
            const domain = getTarget();
            if (domain === null) return;
            const cat =
                document.querySelector(".filter-btn.active")?.dataset
                    ?.cat || "all";
            const list =
                cat === "all" ? DORKS : DORKS.filter((d) => d.cat === cat);
            launchDorks(list, domain, cat.toUpperCase());
        }
        async function launchDorks(list, domain, label) {
            if (
                !confirm(
                    `Open ${list.length} tabs${domain ? ` for "${domain}"` : ""}?\n\nAllow popups if your browser blocks them.`,
                )
            )
                return;
            launchCancelled = false;
            const overlay = document.getElementById("launch-overlay"),
                fill = document.getElementById("launch-fill"),
                status = document.getElementById("launch-status");
            overlay.classList.add("active");
            for (let i = 0; i < list.length; i++) {
                if (launchCancelled) break;
                const d = list[i];
                fill.style.width =
                    Math.round(((i + 1) / list.length) * 100) + "%";
                status.textContent = `[${i + 1}/${list.length}] ${d.label}`;
                window.open(getDorkUrl(d, domain), "_blank");
                searchCount++;
                addHistory(domain, d.label, getDorkUrl(d, domain));
                await new Promise((r) => setTimeout(r, 800));
            }
            document.getElementById("search-count").textContent =
                searchCount;
            overlay.classList.remove("active");
            if (!launchCancelled)
                toast(`✅ Launched ${list.length} dorks`, "success");
        }
        function cancelLaunch() {
            launchCancelled = true;
            document
                .getElementById("launch-overlay")
                .classList.remove("active");
            toast("Cancelled", "warn");
        }

        // ══════════════════════════════════════════
        // FILTERS + DORK SEARCH
        // ══════════════════════════════════════════
        function filterCategory(cat) {
            document
                .querySelectorAll(".filter-btn")
                .forEach((b) => b.classList.remove("active"));
            document
                .querySelector(`[data-cat="${cat}"]`)
                .classList.add("active");
            document
                .querySelectorAll(".category-section[data-cat]")
                .forEach((s) =>
                    s.classList.toggle(
                        "hidden",
                        cat !== "all" && s.dataset.cat !== cat,
                    ),
                );
            document.getElementById("dork-search").value = "";
            searchDorks("");
        }
        function searchDorks(q) {
            q = q.toLowerCase().trim();
            document
                .querySelectorAll(".dork-btn")
                .forEach((btn) =>
                    btn.classList.toggle(
                        "btn-hidden",
                        !!(q && !btn.dataset.label.includes(q)),
                    ),
                );
        }

        // ══════════════════════════════════════════
        // AI ASSIST
        // ══════════════════════════════════════════
        async function runAI() {
            const prompt = document
                .getElementById("ai-prompt")
                .value.trim();
            if (!prompt) {
                toast("Enter a prompt first", "error");
                return;
            }
            const domain = document.getElementById("target").value
                ? cleanDomain(document.getElementById("target").value)
                : "[target domain]";
            await callAI(prompt, domain);
        }
        async function aiQuick(prompt) {
            document.getElementById("ai-prompt").value = prompt;
            const domain = document.getElementById("target").value
                ? cleanDomain(document.getElementById("target").value)
                : "[target domain]";
            await callAI(prompt, domain);
        }
        async function callAI(userPrompt, domain) {
            const btn = document.getElementById("ai-run-btn");
            const respDiv = document.getElementById("ai-response");
            const dorksDiv = document.getElementById("ai-result-dorks");
            btn.disabled = true;
            btn.textContent = "Thinking...";
            respDiv.className = "ai-response visible";
            respDiv.innerHTML = `<div class="ai-thinking"><div class="ai-dot"></div><div class="ai-dot"></div><div class="ai-dot"></div><span style="margin-left:4px;">Claude is thinking...</span></div>`;
            dorksDiv.innerHTML = "";
            const fullPrompt = `You are an expert bug bounty hunter and security researcher. The target domain is: ${domain}

User request: ${userPrompt}

IMPORTANT FORMATTING RULES:
- If you are generating Google dorks, list each one on its own line starting with "DORK:" prefix
- Example: DORK: site:example.com ext:env
- Be specific and practical
- Keep your response concise and actionable
- Focus on 2026 techniques and modern attack surfaces`;

            try {
                const res = await fetch(
                    "https://api.anthropic.com/v1/messages",
                    {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-20250514",
                            max_tokens: 1000,
                            messages: [
                                { role: "user", content: fullPrompt },
                            ],
                        }),
                    },
                );
                const data = await res.json();
                const text =
                    data.content?.map((c) => c.text || "").join("") ||
                    "No response received.";

                // Extract DORK: lines
                const dorkLines = text
                    .split("\n")
                    .filter((l) => l.trim().startsWith("DORK:"));
                const cleanText = text
                    .replace(/^DORK:.*$/gm, "")
                    .replace(/\n{3,}/g, "\n\n")
                    .trim();

                respDiv.textContent = cleanText;

                if (dorkLines.length > 0) {
                    const domain2 = getTarget() || domain;
                    dorksDiv.innerHTML =
                        `<div style="font-family:'Share Tech Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;margin-bottom:8px;">// AI-GENERATED DORKS</div>` +
                        dorkLines
                            .map((line) => {
                                const q = line
                                    .replace(/^DORK:/, "")
                                    .trim()
                                    .replace(/\[target domain\]/g, domain2);
                                const url =
                                    "https://www.google.com/search?q=" +
                                    enc(q);
                                return `<div class="ai-dork-chip"><span>${q}</span><button class="ai-dork-run" onclick="window.open('${url}','_blank');addHistory('${domain2}','AI: ${q.slice(0, 40)}','${url}')">Run ⚡</button></div>`;
                            })
                            .join("");
                }

                // Save to AI history
                aiHistory.unshift({
                    prompt: userPrompt.slice(0, 60) + "...",
                    response: cleanText.slice(0, 100) + "...",
                    time: new Date().toLocaleTimeString([], {
                        hour: "2-digit",
                        minute: "2-digit",
                    }),
                });
                if (aiHistory.length > 10)
                    aiHistory = aiHistory.slice(0, 10);
                renderAIHistory();
                toast("🤖 AI response ready", "ai");
            } catch (err) {
                respDiv.textContent =
                    "Error connecting to AI. Make sure you are using Claude.ai and the API is accessible.";
                toast("AI request failed", "error");
            }
            btn.disabled = false;
            btn.textContent = "⚡ Ask AI";
        }
        function renderAIHistory() {
            const el = document.getElementById("ai-history");
            if (!aiHistory.length) {
                el.innerHTML = "<div>No AI conversations yet.</div>";
                return;
            }
            el.innerHTML = aiHistory
                .map(
                    (h) => `
    <div style="margin-bottom:10px;padding-bottom:10px;border-bottom:1px solid var(--border);">
      <div style="color:var(--accent);margin-bottom:3px;">[${h.time}] ${h.prompt}</div>
      <div style="color:var(--muted);">${h.response}</div>
    </div>`,
                )
                .join("");
        }

        // ══════════════════════════════════════════
        // CUSTOM BUILDER
        // ══════════════════════════════════════════
        function updateBuilderPreview() {
            const domain = document.getElementById("target").value
                ? cleanDomain(document.getElementById("target").value)
                : "target.com";
            const op = document.getElementById("b-op").value,
                val = document.getElementById("b-val").value.trim(),
                mod = document.getElementById("b-mod").value.trim();
            let q =
                op === "custom"
                    ? (val + (mod ? " " + mod : "")).trim()
                    : val
                        ? `site:${domain} ${op}${val}${mod ? " " + mod : ""}`
                        : "";
            document.getElementById("builder-preview").textContent =
                q || "Fill in fields above...";
        }
        function getBuilderQuery() {
            const domain = getTarget() || "target.com",
                op = document.getElementById("b-op").value;
            const val = document.getElementById("b-val").value.trim(),
                mod = document.getElementById("b-mod").value.trim();
            if (!val && op !== "custom") {
                toast("Enter a value first", "error");
                return null;
            }
            return op === "custom"
                ? val + (mod ? " " + mod : "")
                : `site:${domain} ${op}${val}${mod ? " " + mod : ""}`;
        }
        function getBuilderUrl(q) {
            const e2 = {
                google: "https://www.google.com/search?q=",
                bing: "https://www.bing.com/search?q=",
                duckduckgo: "https://duckduckgo.com/?q=",
                yandex: "https://yandex.com/search/?text=",
            };
            return (
                (e2[document.getElementById("b-engine").value] ||
                    e2.google) + enc(q)
            );
        }
        function runBuilderSearch() {
            const q = getBuilderQuery();
            if (!q) return;
            window.open(getBuilderUrl(q), "_blank");
            addHistory(getTarget() || "custom", q, getBuilderUrl(q));
            searchCount++;
            document.getElementById("search-count").textContent =
                searchCount;
            toast("⚡ Launched", "success");
        }
        function copyBuilderQuery() {
            const q = getBuilderQuery();
            if (!q) return;
            navigator.clipboard
                .writeText(q)
                .then(() => toast("📋 Copied", "success"))
                .catch(() => toast("Failed", "error"));
        }
        function saveBuilderDork() {
            const q = getBuilderQuery();
            if (!q) return;
            const name = prompt("Name this dork:");
            if (!name) return;
            savedDorks.unshift({
                name: name.trim(),
                query: q,
                engine: document.getElementById("b-engine").value,
                ts: Date.now(),
            });
            if (savedDorks.length > 50)
                savedDorks = savedDorks.slice(0, 50);
            lsSet("bbse_saved", savedDorks);
            renderSavedDorks();
            toast("💾 Saved", "success");
        }
        function clearBuilder() {
            ["b-val", "b-mod"].forEach(
                (id) => (document.getElementById(id).value = ""),
            );
            document.getElementById("b-op").value = "site:";
            document.getElementById("b-engine").value = "google";
            updateBuilderPreview();
        }
        function renderSavedDorks() {
            const list = document.getElementById("saved-dorks-list");
            document.getElementById("saved-count").textContent =
                savedDorks.length ? `(${savedDorks.length})` : "";
            if (!savedDorks.length) {
                list.innerHTML =
                    '<div class="empty-saved">No saved dorks yet.</div>';
                return;
            }
            list.innerHTML = savedDorks
                .map(
                    (d, i) => `
    <div class="saved-dork-item" onclick="runSavedDork(${i})">
      <span class="saved-dork-name" style="color:var(--accent)">${d.name}</span>
      <span class="saved-dork-query">${d.query}</span>
      <span style="font-size:10px;color:var(--muted);flex-shrink:0;">${d.engine || "google"}</span>
      <button class="saved-dork-del" onclick="deleteSavedDork(event,${i})">✕</button>
    </div>`,
                )
                .join("");
        }
        function runSavedDork(i) {
            const d = savedDorks[i];
            const e2 = {
                google: "https://www.google.com/search?q=",
                bing: "https://www.bing.com/search?q=",
                duckduckgo: "https://duckduckgo.com/?q=",
                yandex: "https://yandex.com/search/?text=",
            };
            const url = (e2[d.engine] || e2.google) + enc(d.query);
            window.open(url, "_blank");
            addHistory(getTarget() || "custom", d.name, url);
            searchCount++;
            document.getElementById("search-count").textContent =
                searchCount;
            toast(`⚡ ${d.name}`, "success");
        }
        function deleteSavedDork(ev, i) {
            ev.stopPropagation();
            savedDorks.splice(i, 1);
            lsSet("bbse_saved", savedDorks);
            renderSavedDorks();
            toast("Deleted", "warn");
        }

        // ══════════════════════════════════════════
        // CHECKLIST
        // ══════════════════════════════════════════
        function renderChecklist() {
            const c = document.getElementById("checklist-container");
            c.innerHTML = CHECKLIST.map(
                (s) => `
    <div class="checklist-section-header">${s.section}</div>
    <div class="checklist-grid">${s.items
                        .map((item) => {
                            const done = !!checklistState[item.id];
                            return `
      <div class="checklist-item${done ? " done" : ""}" onclick="toggleCheck('${item.id}')">
        <div class="check-box">${done ? "✓" : ""}</div>
        <div><div class="check-text">${item.label}</div><div class="check-sub">${item.sub}</div></div>
      </div>`;
                        })
                        .join("")}
    </div>`,
            ).join("");
        }
        function toggleCheck(id) {
            checklistState[id] = !checklistState[id];
            lsSet("bbse_checklist", checklistState);
            renderChecklist();
            updateChecklistStats();
        }
        function updateChecklistStats() {
            const total = CHECKLIST.reduce((s, c) => s + c.items.length, 0);
            const done =
                Object.values(checklistState).filter(Boolean).length;
            const pct = total ? Math.round((done / total) * 100) : 0;
            document.getElementById("checklist-bar").style.width =
                pct + "%";
            document.getElementById("checklist-prog-text").textContent =
                `${done} / ${total}`;
            document.getElementById("checklist-pct").textContent =
                pct + "%";
        }
        function resetChecklist() {
            if (!confirm("Reset?")) return;
            checklistState = {};
            lsSet("bbse_checklist", {});
            renderChecklist();
            updateChecklistStats();
            toast("Reset", "warn");
        }

        // ══════════════════════════════════════════
        // NOTES
        // ══════════════════════════════════════════
        function loadNotes() {
            const notes = localStorage.getItem("bbse_notes") || "";
            document.getElementById("notes-area").value = notes;
            updateNotesCount(notes);
            document.getElementById("notes-save-status").textContent = notes
                ? "Loaded from storage"
                : "Empty";
        }
        function saveNotes() {
            const val = document.getElementById("notes-area").value;
            localStorage.setItem("bbse_notes", val);
            updateNotesCount(val);
            document.getElementById("notes-save-status").textContent =
                "Saved " +
                new Date().toLocaleTimeString([], {
                    hour: "2-digit",
                    minute: "2-digit",
                });
        }
        function updateNotesCount(val) {
            document.getElementById("notes-char-count").textContent =
                val.length +
                " chars / " +
                val.split("\n").length +
                " lines";
        }
        function insertNote(text) {
            const ta = document.getElementById("notes-area");
            const start = ta.selectionStart;
            ta.value =
                ta.value.slice(0, start) + text + ta.value.slice(start);
            ta.selectionStart = ta.selectionEnd = start + text.length;
            ta.focus();
            saveNotes();
        }
        function copyNotes() {
            navigator.clipboard
                .writeText(document.getElementById("notes-area").value)
                .then(() => toast("📋 Copied", "success"));
        }
        function clearNotes() {
            if (!confirm("Clear all notes?")) return;
            document.getElementById("notes-area").value = "";
            saveNotes();
            toast("Notes cleared", "warn");
        }
        function exportNotes() {
            const val = document.getElementById("notes-area").value;
            if (!val) {
                toast("No notes", "error");
                return;
            }
            const a = document.createElement("a");
            a.href = URL.createObjectURL(
                new Blob([val], { type: "text/plain" }),
            );
            a.download = `recon-notes-${new Date().toISOString().slice(0, 10)}.txt`;
            a.click();
            toast("⬇ Exported", "success");
        }

        // ══════════════════════════════════════════
        // SCOPE CHECKER
        // ══════════════════════════════════════════
        function loadScope() {
            document.getElementById("scope-input").value =
                localStorage.getItem("bbse_scope") || "";
            document.getElementById("program-notes").value =
                localStorage.getItem("bbse_program") || "";
        }
        function saveScopeList() {
            localStorage.setItem(
                "bbse_scope",
                document.getElementById("scope-input").value,
            );
        }
        function saveProgramNotes() {
            localStorage.setItem(
                "bbse_program",
                document.getElementById("program-notes").value,
            );
        }
        function checkScope() {
            const raw = document
                .getElementById("scope-check-input")
                .value.trim();
            const result = document.getElementById("scope-result");
            if (!raw) {
                result.textContent = "Enter a domain above.";
                result.className = "";
                return;
            }
            const domain = cleanDomain(raw);
            const scopeLines = document
                .getElementById("scope-input")
                .value.split("\n")
                .map((l) => l.trim())
                .filter(Boolean);
            if (!scopeLines.length) {
                result.innerHTML =
                    '<span class="scope-warn">⚠ No scope defined above.</span>';
                return;
            }

            const matched = scopeLines.find((s) => {
                const pattern = s
                    .replace(/\./g, "\\.")
                    .replace(/\*/g, "[^.]+");
                return new RegExp("^" + pattern + "$", "i").test(domain);
            });

            if (matched) {
                result.innerHTML = `<span class="scope-in">✓ IN SCOPE — matches "${matched}"</span>`;
            } else {
                result.innerHTML = `<span class="scope-out">✗ OUT OF SCOPE — no matching pattern found</span>`;
            }
        }

        // ══════════════════════════════════════════
        // EXPORT
        // ══════════════════════════════════════════
        function runExport(type) {
            const domain = document.getElementById("target").value
                ? cleanDomain(document.getElementById("target").value)
                : "TARGET";
            const ts = new Date().toISOString().slice(0, 10);
            let content = "",
                filename = "";
            if (type === "txt") {
                content =
                    `# DorkHunt Export — ${domain} — ${ts}\n\n` +
                    DORKS.map(
                        (d) =>
                            `[${d.cat.toUpperCase()}] ${d.label}\n${getDorkUrl(d, domain || "TARGET")}`,
                    ).join("\n\n");
                filename = `dorks-${domain}-${ts}.txt`;
            } else if (type === "markdown") {
                content = `# 🎯 DorkHunt Report\n**Target:** \`${domain}\`  \n**Date:** ${ts}\n\n`;
                [...new Set(DORKS.map((d) => d.cat))].forEach((cat) => {
                    content += `## ${cat.toUpperCase()}\n\n`;
                    DORKS.filter((d) => d.cat === cat).forEach((d) => {
                        content += `- [${d.label}](${getDorkUrl(d, domain || "TARGET")})\n`;
                    });
                    content += "\n";
                });
                filename = `dorks-${domain}-${ts}.md`;
            } else if (type === "urls") {
                content = DORKS.map((d) =>
                    getDorkUrl(d, domain || "TARGET"),
                ).join("\n");
                filename = `dork-urls-${domain}-${ts}.txt`;
            } else if (type === "json") {
                content = JSON.stringify(
                    {
                        target: domain,
                        exported: ts,
                        total: DORKS.length,
                        dorks: DORKS.map((d) => ({
                            id: d.id,
                            cat: d.cat,
                            label: d.label,
                            url: getDorkUrl(d, domain || "TARGET"),
                        })),
                    },
                    null,
                    2,
                );
                filename = `dorks-${domain}-${ts}.json`;
            } else if (type === "history") {
                content = history.length
                    ? history
                        .map(
                            (h) =>
                                `[${h.time}] ${h.domain} | ${h.action}\n${h.url}`,
                        )
                        .join("\n\n")
                    : "No history.";
                filename = `history-${ts}.txt`;
            } else if (type === "saved") {
                content = savedDorks.length
                    ? savedDorks
                        .map(
                            (d) =>
                                `# ${d.name} [${d.engine}]\n${d.query}`,
                        )
                        .join("\n\n")
                    : "No saved dorks.";
                filename = `saved-dorks-${ts}.txt`;
            } else if (type === "notes") {
                content = localStorage.getItem("bbse_notes") || "No notes.";
                filename = `recon-notes-${domain}-${ts}.txt`;
            } else if (type === "favorites") {
                const favDorks = DORKS.filter((d) =>
                    favorites.includes(String(d.id)),
                );
                content = favDorks.length
                    ? favDorks
                        .map(
                            (d) =>
                                `[${d.cat}] ${d.label}\n${getDorkUrl(d, domain || "TARGET")}`,
                        )
                        .join("\n\n")
                    : "No favorites.";
                filename = `favorites-${ts}.txt`;
            }
            exportContent = content;
            exportFilename = filename;
            const area = document.getElementById("export-preview");
            area.textContent =
                content.slice(0, 2500) +
                (content.length > 2500 ? "\n\n...(truncated)" : "");
            area.classList.add("visible");
            document.getElementById("export-action-btns").style.display =
                "flex";
            toast(`Preview ready — ${filename}`, "success");
        }
        function downloadExport() {
            if (!exportContent) return;
            const a = document.createElement("a");
            a.href = URL.createObjectURL(
                new Blob([exportContent], { type: "text/plain" }),
            );
            a.download = exportFilename;
            a.click();
            toast("⬇ Downloaded", "success");
        }
        function copyExport() {
            if (!exportContent) return;
            navigator.clipboard
                .writeText(exportContent)
                .then(() => toast("📋 Copied", "success"))
                .catch(() => toast("Failed", "error"));
        }

        // ══════════════════════════════════════════
        // HISTORY
        // ══════════════════════════════════════════
        function addHistory(domain, action, url) {
            history.unshift({
                domain,
                action,
                url,
                time: new Date().toLocaleTimeString([], {
                    hour: "2-digit",
                    minute: "2-digit",
                }),
            });
            if (history.length > 50) history = history.slice(0, 50);
            lsSet("bbse_history", history);
            renderHistory();
        }
        function renderHistory() {
            const list = document.getElementById("history-list");
            if (!history.length) {
                list.innerHTML =
                    '<div class="empty-history">No searches yet.</div>';
                return;
            }
            list.innerHTML = history
                .map(
                    (item) => `
    <div class="history-item" onclick="window.open(${JSON.stringify(item.url)},'_blank')">
      <span class="history-domain">${item.domain}</span>
      <span class="history-action">${item.action}</span>
      <span class="history-time">${item.time}</span>
    </div>`,
                )
                .join("");
        }
        function clearHistory() {
            history = [];
            lsSet("bbse_history", []);
            renderHistory();
            toast("Cleared", "warn");
        }
        function exportHistory() {
            if (!history.length) {
                toast("No history", "error");
                return;
            }
            const a = document.createElement("a");
            a.href = URL.createObjectURL(
                new Blob(
                    [
                        history
                            .map(
                                (h) =>
                                    `[${h.time}] ${h.domain} | ${h.action}\n${h.url}`,
                            )
                            .join("\n\n"),
                    ],
                    { type: "text/plain" },
                ),
            );
            a.download = `history-${new Date().toISOString().slice(0, 10)}.txt`;
            a.click();
            toast("⬇ Exported", "success");
        }

        // ══════════════════════════════════════════
        // METHODOLOGY
        // ══════════════════════════════════════════

        // Store original commands for reset
        let originalCommands = {};
        let methodologyInitialized = false;

        function initMethodology() {
            if (methodologyInitialized) return;
            // Store original command texts
            document.querySelectorAll('.method-cmd').forEach(cmd => {
                if (cmd.id) {
                    originalCommands[cmd.id] = cmd.textContent;
                }
            });
            methodologyInitialized = true;
        }

        // Auto-update methodology when target input changes
        function setupMethodologyAutoUpdate() {
            const targetInput = document.getElementById('target');
            if (targetInput) {
                // Remove existing listeners to prevent duplicates
                targetInput.removeEventListener('input', handleTargetChange);
                targetInput.removeEventListener('blur', handleTargetChange);

                targetInput.addEventListener('input', handleTargetChange);
                targetInput.addEventListener('blur', handleTargetChange);
            }
        }

        function handleTargetChange() {
            initMethodology();
            updateMethodologyCommands();
            updateExploitTarget();
        }

        function updateMethodologyCommands() {
            initMethodology();
            const target = getTarget();
            const displayTarget = target || 'TARGET';

            // Update methodology target display
            const methodTarget = document.getElementById('method-target');
            if (methodTarget) {
                methodTarget.textContent = target ? target : 'Not set';
            }

            // Update all methodology commands with the target
            document.querySelectorAll('.method-cmd:not(.exploit-cmd)').forEach(cmd => {
                if (cmd.id && originalCommands[cmd.id]) {
                    const newText = originalCommands[cmd.id].replace(/TARGET/g, displayTarget);
                    cmd.textContent = newText;
                }
            });
        }

        function updateExploitTarget() {
            const target = getTarget();
            const exploitTarget = document.getElementById('exploit-target');
            if (exploitTarget) {
                exploitTarget.textContent = target ? target : 'Not set';
            }

            // Update exploit CLI commands
            const exploitCmds = {
                'cmd-exp-nuclei': `nuclei -u https://${target || 'EXPLOITTARGET'} -t ~/nuclei-templates/cves/ -severity critical,high`,
                'cmd-exp-nmap': `nmap --script vuln ${target || 'EXPLOITTARGET'} -oN vuln-scan.txt`
            };

            Object.entries(exploitCmds).forEach(([id, cmd]) => {
                const el = document.getElementById(id);
                if (el) el.textContent = cmd;
            });
        }

        // Initialize on page load
        window.addEventListener('load', function () {
            setTimeout(() => {
                initMethodology();
                setupMethodologyAutoUpdate();
                updateMethodologyCommands();
                updateExploitTarget();
            }, 200);
        });

        function toggleMethodStep(header) {
            const step = header.parentElement;
            step.classList.toggle('collapsed');
        }

        function updateMethodologyTarget() {
            const target = getTarget() || 'TARGET';
            document.getElementById('method-target').textContent = target === 'TARGET' ? 'Not set' : target;
            updateMethodologyCommands();
        }

        // Exploit Search Functions
        function searchExploits() {
            const searchTerm = document.getElementById('exploit-search-term').value.trim();
            if (!searchTerm) {
                toast('⚠ Please enter a service/version to search', 'error');
                return;
            }

            // Update searchsploit command with search term
            const searchsploitCmd = document.getElementById('cmd-searchsploit');
            if (searchsploitCmd) {
                searchsploitCmd.textContent = `searchsploit "${searchTerm}" --json > exploits.json`;
            }

            // Update metasploit command
            const msfCmd = document.getElementById('cmd-msf');
            if (msfCmd) {
                msfCmd.textContent = `msfconsole -q -x "search type:exploit ${searchTerm}; exit"`;
            }

            toast('✅ Commands updated with: ' + searchTerm, 'success');

            // Open all exploit databases in new tabs
            const urls = getExploitUrls(searchTerm);

            // Ask if user wants to open all
            if (confirm(`Open all ${Object.keys(urls).length} exploit databases for "${searchTerm}"?`)) {
                Object.values(urls).forEach((url, index) => {
                    setTimeout(() => window.open(url, '_blank'), index * 300);
                });
            }
        }

        function getExploitUrls(searchTerm) {
            const encoded = encodeURIComponent(searchTerm);
            return {
                'github-poc': `https://github.com/search?q=${encoded}+poc&type=repositories`,
                'github-exploit': `https://github.com/search?q=${encoded}+exploit&type=repositories`,
                'exploitdb': `https://www.exploit-db.com/search?q=${encoded}`,
                'nvd': `https://nvd.nist.gov/vuln/search/results?query=${encoded}`,
                'packetstorm': `https://packetstormsecurity.com/search/?q=${encoded}`,
                'vulners': `https://vulners.com/search?query=${encoded}`,
                'cvedetails': `https://www.cvedetails.com/google-search-results.php?q=${encoded}`,
                'rapid7': `https://www.rapid7.com/db/?q=${encoded}`,
                'nuclei-templates': `https://github.com/search?q=repo%3Aprojectdiscovery%2Fnuclei-templates+${encoded}&type=code`,
                'snyk': `https://security.snyk.io/search?q=${encoded}`
            };
        }

        function openExploitSearch(dbType, event) {
            event.preventDefault();
            const searchTerm = document.getElementById('exploit-search-term').value.trim();

            if (!searchTerm) {
                toast('⚠ Please enter a service/version first', 'error');
                document.getElementById('exploit-search-term').focus();
                return;
            }

            const urls = getExploitUrls(searchTerm);
            const url = urls[dbType];

            if (url) {
                window.open(url, '_blank');
                toast('🔍 Searching ' + dbType + '...', 'success');
            }
        }

        // ══════════════════════════════════════════
        // EXPLOITS TAB
        // ══════════════════════════════════════════

        function setExploitSearch(term) {
            const input = document.getElementById('exploit-service-input');
            if (input) {
                input.value = term;
                input.focus();
            }
        }

        function getAllExploitUrls(searchTerm) {
            const encoded = encodeURIComponent(searchTerm);
            return {
                // GitHub & Code Repos
                'github-poc': `https://github.com/search?q=${encoded}+poc&type=repositories`,
                'github-exploit': `https://github.com/search?q=${encoded}+exploit&type=repositories`,
                'github-cve': `https://github.com/search?q=${encoded}+CVE&type=repositories`,
                'gitlab': `https://gitlab.com/search?search=${encoded}+exploit`,
                'github-nuclei': `https://github.com/search?q=repo%3Aprojectdiscovery%2Fnuclei-templates+${encoded}&type=code`,
                'github-0day': `https://github.com/search?q=${encoded}+0day&type=repositories`,

                // Exploit Databases
                'exploitdb': `https://www.exploit-db.com/search?q=${encoded}`,
                'packetstorm': `https://packetstormsecurity.com/search/?q=${encoded}`,
                'rapid7': `https://www.rapid7.com/db/?q=${encoded}`,
                '0day-today': `https://0day.today/search?search_request=${encoded}`,
                'sploitus': `https://sploitus.com/?query=${encoded}`,
                'vulncode': `https://www.vulncode-db.com/search?q=${encoded}`,

                // CVE & Vulnerability DBs
                'nvd': `https://nvd.nist.gov/vuln/search/results?query=${encoded}`,
                'cvedetails': `https://www.cvedetails.com/google-search-results.php?q=${encoded}`,
                'vulners': `https://vulners.com/search?query=${encoded}`,
                'snyk': `https://security.snyk.io/search?q=${encoded}`,
                'cisa': `https://www.cisa.gov/search?g=${encoded}`,
                'mitre': `https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=${encoded}`,

                // Vendor Advisories
                'microsoft': `https://msrc.microsoft.com/update-guide/vulnerability?search=${encoded}`,
                'oracle': `https://www.oracle.com/security-alerts/?search=${encoded}`,
                'cisco': `https://sec.cloudapps.cisco.com/security/center/search.x?search=${encoded}`,
                'redhat': `https://access.redhat.com/security/security-updates/?q=${encoded}`,
                'ubuntu': `https://ubuntu.com/security/cves?q=${encoded}`,
                'debian': `https://security-tracker.debian.org/tracker/?query=${encoded}`,

                // Security Research
                'google-security': `https://www.google.com/search?q=site:googleprojectzero.blogspot.com+${encoded}`,
                'hackerone': `https://hackerone.com/hacktivity?search=${encoded}`,
                'portswigger': `https://portswigger.net/search?q=${encoded}`,
                'tenable': `https://www.tenable.com/plugins/search?q=${encoded}`,
                'qualys': `https://www.qualys.com/search/?q=${encoded}`,
                'trendmicro': `https://www.trendmicro.com/vinfo/us/search/results?q=${encoded}`
            };
        }

        function searchAllExploits() {
            const searchTerm = document.getElementById('exploit-service-input').value.trim();
            if (!searchTerm) {
                toast('⚠ Please enter a service/version to search', 'error');
                return;
            }

            // Update CLI commands
            const searchsploitCmd = document.getElementById('cmd-exp-searchsploit');
            if (searchsploitCmd) {
                searchsploitCmd.textContent = `searchsploit "${searchTerm}" --json > exploits.json`;
            }

            const msfCmd = document.getElementById('cmd-exp-msf');
            if (msfCmd) {
                msfCmd.textContent = `msfconsole -q -x "search type:exploit ${searchTerm}; exit"`;
            }

            toast('✅ Commands updated with: ' + searchTerm, 'success');

            // Ask to open all databases
            const urls = getAllExploitUrls(searchTerm);
            const count = Object.keys(urls).length;

            if (confirm(`Open all ${count} exploit databases for "${searchTerm}"?\n\nThis will open ${count} new tabs.`)) {
                let delay = 0;
                Object.values(urls).forEach((url) => {
                    setTimeout(() => window.open(url, '_blank'), delay);
                    delay += 200;
                });
                toast(`🚀 Opening ${count} exploit databases...`, 'success');
            }
        }

        function openExploitDB(dbType, event) {
            event.preventDefault();
            const searchTerm = document.getElementById('exploit-service-input').value.trim();

            if (!searchTerm) {
                toast('⚠ Please enter a service/version first', 'error');
                document.getElementById('exploit-service-input').focus();
                return;
            }

            const urls = getAllExploitUrls(searchTerm);
            const url = urls[dbType];

            if (url) {
                window.open(url, '_blank');
                toast('🔍 Searching ' + dbType.replace('-', ' ') + '...', 'success');
            }
        }

        function copyExploitCmd(cmdId) {
            const cmdEl = document.getElementById(cmdId);
            if (!cmdEl) return;

            const text = cmdEl.textContent;
            navigator.clipboard.writeText(text).then(() => {
                toast('📋 Command copied!', 'success');
            }).catch(() => {
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                toast('📋 Command copied!', 'success');
            });
        }

        function generateAllCommands() {
            const target = getTarget();
            if (target === null) return;

            updateMethodologyTarget();
            toast('✅ Commands generated for ' + target, 'success');

            // Expand all steps
            document.querySelectorAll('.method-step').forEach(step => {
                step.classList.remove('collapsed');
            });
        }

        function copyMethodCmd(cmdId) {
            const cmdEl = document.getElementById(cmdId);
            const target = getTarget() || 'TARGET';
            let text = cmdEl.textContent.replace(/TARGET/g, target);

            navigator.clipboard.writeText(text).then(() => {
                toast('📋 Command copied!', 'success');
            }).catch(() => {
                // Fallback
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                toast('📋 Command copied!', 'success');
            });
        }

        function copyAllCommands() {
            const target = getTarget() || 'TARGET';
            const commands = [];

            commands.push('#!/bin/bash');
            commands.push('# Bug Bounty Recon Methodology');
            commands.push('# Target: ' + target);
            commands.push('# Generated by haxclaw');
            commands.push('');
            commands.push('TARGET="' + target + '"');
            commands.push('mkdir -p recon-$TARGET && cd recon-$TARGET');
            commands.push('');

            document.querySelectorAll('.method-step').forEach(step => {
                const title = step.querySelector('.method-step-title').textContent;
                commands.push('# ' + title);
                commands.push('echo "[*] ' + title + '"');

                step.querySelectorAll('.method-cmd').forEach(cmd => {
                    let text = cmd.textContent.replace(/TARGET/g, '$TARGET');
                    commands.push(text);
                });
                commands.push('');
            });

            const allText = commands.join('\n');

            navigator.clipboard.writeText(allText).then(() => {
                toast('📋 All commands copied as bash script!', 'success');
            }).catch(() => {
                const ta = document.createElement('textarea');
                ta.value = allText;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                toast('📋 All commands copied!', 'success');
            });
        }

        function exportMethodology() {
            const target = getTarget() || 'TARGET';
            const commands = [];

            commands.push('#!/bin/bash');
            commands.push('#');
            commands.push('# ███ BUG BOUNTY RECON SCRIPT ███');
            commands.push('# Target: ' + target);
            commands.push('# Generated by haxclaw - Advanced Bug Bounty Recon Engine');
            commands.push('# https://www.instagram.com/un1kn0n3_h4rt/');
            commands.push('#');
            commands.push('');
            commands.push('set -e');
            commands.push('');
            commands.push('# Colors');
            commands.push('RED="\\033[0;31m"');
            commands.push('GREEN="\\033[0;32m"');
            commands.push('YELLOW="\\033[1;33m"');
            commands.push('CYAN="\\033[0;36m"');
            commands.push('NC="\\033[0m"');
            commands.push('');
            commands.push('TARGET="' + target + '"');
            commands.push('OUTPUT_DIR="recon-$TARGET-$(date +%Y%m%d_%H%M%S)"');
            commands.push('');
            commands.push('echo -e "${CYAN}"');
            commands.push('echo "██████  ███████ ██████  ███████ ███    ██"');
            commands.push('echo "██   ██ ██      ██   ██ ██      ████   ██"');
            commands.push('echo "██████  █████   ██      █████   ██ ██  ██"');
            commands.push('echo "██   ██ ██      ██   ██ ██      ██  ██ ██"');
            commands.push('echo "██   ██ ███████ ██████  ███████ ██   ████"');
            commands.push('echo -e "${NC}"');
            commands.push('echo -e "${YELLOW}[*] Target: $TARGET${NC}"');
            commands.push('echo -e "${YELLOW}[*] Output: $OUTPUT_DIR${NC}"');
            commands.push('echo ""');
            commands.push('');
            commands.push('mkdir -p "$OUTPUT_DIR" && cd "$OUTPUT_DIR"');
            commands.push('');

            document.querySelectorAll('.method-step').forEach((step, index) => {
                const title = step.querySelector('.method-step-title').textContent;
                const num = String(index + 1).padStart(2, '0');

                commands.push('# ═══════════════════════════════════════');
                commands.push('# STEP ' + num + ': ' + title);
                commands.push('# ═══════════════════════════════════════');
                commands.push('echo -e "${GREEN}[STEP ' + num + '] ' + title + '${NC}"');
                commands.push('');

                step.querySelectorAll('.method-cmd-block').forEach(block => {
                    const label = block.querySelector('.method-cmd-label').textContent;
                    const cmd = block.querySelector('.method-cmd').textContent.replace(/TARGET/g, '$TARGET');

                    commands.push('# ' + label);
                    commands.push('echo -e "${CYAN}  [-] Running: ' + label + '${NC}"');
                    commands.push(cmd + ' 2>/dev/null || echo -e "${RED}  [!] ' + label + ' failed or not installed${NC}"');
                    commands.push('');
                });

                commands.push('');
            });

            commands.push('echo ""');
            commands.push('echo -e "${GREEN}███ RECON COMPLETE ███${NC}"');
            commands.push('echo -e "${YELLOW}[*] Results saved in: $OUTPUT_DIR${NC}"');
            commands.push('echo -e "${CYAN}[*] Happy Hunting! haxclaw${NC}"');

            const scriptContent = commands.join('\n');
            const blob = new Blob([scriptContent], { type: 'text/x-shellscript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'recon-' + target.replace(/\./g, '-') + '.sh';
            a.click();
            URL.revokeObjectURL(url);

            toast('📥 Bash script downloaded!', 'success');
        }

        // Update methodology target when main target changes
        const originalValidateInput = validateInput;
        validateInput = function (input) {
            const result = originalValidateInput(input);
            // Update methodology target display
            const methodTarget = document.getElementById('method-target');
            if (methodTarget) {
                const target = getTarget();
                methodTarget.textContent = target || 'Not set';
            }
            return result;
        };

        // ══════════════════════════════════════════
        // TABS
        // ══════════════════════════════════════════
        function switchTab(id, btn) {
            document
                .querySelectorAll(".tab-btn")
                .forEach((b) => b.classList.remove("active"));
            document
                .querySelectorAll(".tab-panel")
                .forEach((p) => p.classList.remove("active"));
            if (btn) btn.classList.add("active");
            else
                document
                    .querySelector(`[data-tab="${id}"]`)
                    ?.classList.add("active");
            document.getElementById("tab-" + id).classList.add("active");
        }

        // ══════════════════════════════════════════
        // THEME
        // ══════════════════════════════════════════
        function loadTheme() {
            const t = localStorage.getItem("bbse_theme") || "dark";
            if (t === "light") {
                document.documentElement.setAttribute(
                    "data-theme",
                    "light",
                );
                document.getElementById("theme-btn").textContent = "☀️";
            }
        }
        function toggleTheme() {
            const isLight =
                document.documentElement.getAttribute("data-theme") ===
                "light";
            document.documentElement.setAttribute(
                "data-theme",
                isLight ? "dark" : "light",
            );
            document.getElementById("theme-btn").textContent = isLight
                ? "🌙"
                : "☀️";
            localStorage.setItem("bbse_theme", isLight ? "dark" : "light");
            toast(isLight ? "Dark mode" : "Light mode", "success");
        }

        // ══════════════════════════════════════════
        // KEYBOARD SHORTCUTS
        // ══════════════════════════════════════════
        function showKbModal() {
            document.getElementById("kb-modal").classList.add("active");
        }
        function closeKbModal() {
            document.getElementById("kb-modal").classList.remove("active");
        }
        document.addEventListener("keydown", (ev) => {
            if (
                ev.target.tagName === "INPUT" ||
                ev.target.tagName === "TEXTAREA"
            )
                return;
            if (ev.key === "?") {
                showKbModal();
                return;
            }
            if (ev.key === "Escape") {
                closeKbModal();
                document
                    .getElementById("launch-overlay")
                    .classList.remove("active");
                return;
            }
            if (ev.ctrlKey || ev.metaKey) {
                const tabs = [
                    "dorks",
                    "ai",
                    "favorites",
                    "builder",
                    "checklist",
                    "notes",
                    "scope",
                    "export",
                    "methodology",
                    "exploits",
                ];
                const num = parseInt(ev.key);
                if (num >= 1 && num <= 10) {
                    ev.preventDefault();
                    switchTab(tabs[num - 1], null);
                    return;
                }
                if (ev.key === "k") {
                    ev.preventDefault();
                    document.getElementById("target").focus();
                    return;
                }
                if (ev.key === "f") {
                    ev.preventDefault();
                    document.getElementById("dork-search")?.focus();
                    return;
                }
                if (ev.key === "s") {
                    ev.preventDefault();
                    saveTarget();
                    return;
                }
            }
        });

        // ══════════════════════════════════════════
        // TOAST (multi-stack)
        // ══════════════════════════════════════════
        function toast(msg, type = "") {
            const stack = document.getElementById("toast-stack");
            const el = document.createElement("div");
            el.className = "toast " + type;
            el.textContent = msg;
            stack.appendChild(el);
            requestAnimationFrame(() =>
                requestAnimationFrame(() => el.classList.add("show")),
            );
            setTimeout(() => {
                el.classList.remove("show");
                setTimeout(() => el.remove(), 300);
            }, 2400);
        }

        // ══════════════════════════════════════════
        // BOOT
        // ══════════════════════════════════════════
        init();
    </script>
</body>

</html>